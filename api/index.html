<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Transform any Python function into a complete web app automatically. Just type hints and run()"><meta name=author content="BeltrÃ¡n Offerrall"><link href=../server-configuration/ rel=prev><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.0"><title>API - FuncToWeb</title><link rel=stylesheet href=../assets/stylesheets/main.618322db.min.css><link rel=stylesheet href=../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/_mkdocstrings.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#api-reference class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=FuncToWeb class="md-header__button md-logo" aria-label=FuncToWeb data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> FuncToWeb </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> API </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__source> <a href=https://github.com/offerrall/FuncToWeb title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> FuncToWeb </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../types/ class=md-tabs__link> Input Types </a> </li> <li class=md-tabs__item> <a href=../constraints/ class=md-tabs__link> Types Constraints </a> </li> <li class=md-tabs__item> <a href=../images/ class=md-tabs__link> Output Types </a> </li> <li class=md-tabs__item> <a href=../function-descriptions/ class=md-tabs__link> Other Features </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> API </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=FuncToWeb class="md-nav__button md-logo" aria-label=FuncToWeb data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> FuncToWeb </label> <div class=md-nav__source> <a href=https://github.com/offerrall/FuncToWeb title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> FuncToWeb </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Input Types </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Input Types </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../types/ class=md-nav__link> <span class=md-ellipsis> Basic Types </span> </a> </li> <li class=md-nav__item> <a href=../files/ class=md-nav__link> <span class=md-ellipsis> File Types </span> </a> </li> <li class=md-nav__item> <a href=../lists/ class=md-nav__link> <span class=md-ellipsis> Lists </span> </a> </li> <li class=md-nav__item> <a href=../optional/ class=md-nav__link> <span class=md-ellipsis> Optional Parameters </span> </a> </li> <li class=md-nav__item> <a href=../dropdowns/ class=md-nav__link> <span class=md-ellipsis> Dropdowns </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../constraints/ class=md-nav__link> <span class=md-ellipsis> Types Constraints </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Output Types </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Output Types </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../images/ class=md-nav__link> <span class=md-ellipsis> Images & Plots </span> </a> </li> <li class=md-nav__item> <a href=../downloads/ class=md-nav__link> <span class=md-ellipsis> File Downloads </span> </a> </li> <li class=md-nav__item> <a href=../tables/ class=md-nav__link> <span class=md-ellipsis> Tables </span> </a> </li> <li class=md-nav__item> <a href=../multiple-outputs/ class=md-nav__link> <span class=md-ellipsis> Multiple Outputs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Other Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Other Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../function-descriptions/ class=md-nav__link> <span class=md-ellipsis> Function Descriptions </span> </a> </li> <li class=md-nav__item> <a href=../multiple/ class=md-nav__link> <span class=md-ellipsis> Multiple Functions </span> </a> </li> <li class=md-nav__item> <a href=../authentication/ class=md-nav__link> <span class=md-ellipsis> Authentication </span> </a> </li> <li class=md-nav__item> <a href=../dark-mode/ class=md-nav__link> <span class=md-ellipsis> Dark Mode </span> </a> </li> <li class=md-nav__item> <a href=../server-configuration/ class=md-nav__link> <span class=md-ellipsis> Server Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> API </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#func_to_web class=md-nav__link> <span class=md-ellipsis> func_to_web </span> </a> <nav class=md-nav aria-label=func_to_web> <ul class=md-nav__list> <li class=md-nav__item> <a href=#func_to_web.cleanup_temp_file class=md-nav__link> <span class=md-ellipsis> cleanup_temp_file </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.create_response_with_files class=md-nav__link> <span class=md-ellipsis> create_response_with_files </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.get_temp_file class=md-nav__link> <span class=md-ellipsis> get_temp_file </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.handle_form_submission class=md-nav__link> <span class=md-ellipsis> handle_form_submission </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.register_temp_file class=md-nav__link> <span class=md-ellipsis> register_temp_file </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.run class=md-nav__link> <span class=md-ellipsis> run </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.save_uploaded_file class=md-nav__link> <span class=md-ellipsis> save_uploaded_file </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#func_to_web.types class=md-nav__link> <span class=md-ellipsis> types </span> </a> <nav class=md-nav aria-label=types> <ul class=md-nav__list> <li class=md-nav__item> <a href=#func_to_web.types.FileResponse class=md-nav__link> <span class=md-ellipsis> FileResponse </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#func_to_web.analyze_function class=md-nav__link> <span class=md-ellipsis> analyze_function </span> </a> <nav class=md-nav aria-label=analyze_function> <ul class=md-nav__list> <li class=md-nav__item> <a href=#func_to_web.analyze_function.ParamInfo class=md-nav__link> <span class=md-ellipsis> ParamInfo </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.analyze_function.analyze class=md-nav__link> <span class=md-ellipsis> analyze </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#func_to_web.build_form_fields class=md-nav__link> <span class=md-ellipsis> build_form_fields </span> </a> <nav class=md-nav aria-label=build_form_fields> <ul class=md-nav__list> <li class=md-nav__item> <a href=#func_to_web.build_form_fields.build_form_fields class=md-nav__link> <span class=md-ellipsis> build_form_fields </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.build_form_fields.serialize_for_json class=md-nav__link> <span class=md-ellipsis> serialize_for_json </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#func_to_web.process_result class=md-nav__link> <span class=md-ellipsis> process_result </span> </a> <nav class=md-nav aria-label=process_result> <ul class=md-nav__list> <li class=md-nav__item> <a href=#func_to_web.process_result.process_result class=md-nav__link> <span class=md-ellipsis> process_result </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#func_to_web.validate_params class=md-nav__link> <span class=md-ellipsis> validate_params </span> </a> <nav class=md-nav aria-label=validate_params> <ul class=md-nav__list> <li class=md-nav__item> <a href=#func_to_web.validate_params.validate_list_param class=md-nav__link> <span class=md-ellipsis> validate_list_param </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.validate_params.validate_params class=md-nav__link> <span class=md-ellipsis> validate_params </span> </a> </li> <li class=md-nav__item> <a href=#func_to_web.validate_params.validate_single_item class=md-nav__link> <span class=md-ellipsis> validate_single_item </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=api-reference>API Reference</h1> <div class="doc doc-object doc-module"> <h2 id=func_to_web class="doc doc-heading"> <code>func_to_web</code> </h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=func_to_web.cleanup_temp_file class="doc doc-heading"> <code class="highlight language-python"><span class=n>cleanup_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Remove temp file and its registry entry.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>file_id</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Unique identifier for the file.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\__init__.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=k>def</span><span class=w> </span><span class=nf>cleanup_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Remove temp file and its registry entry.</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=sd>    Args:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=sd>        file_id: Unique identifier for the file.</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>TEMP_FILES_REGISTRY</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>            <span class=k>return</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>TEMP_FILES_REGISTRY</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>            <span class=n>registry</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>        <span class=k>if</span> <span class=n>file_id</span> <span class=ow>in</span> <span class=n>registry</span><span class=p>:</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=n>path</span> <span class=o>=</span> <span class=n>registry</span><span class=p>[</span><span class=n>file_id</span><span class=p>][</span><span class=s1>&#39;path&#39;</span><span class=p>]</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>                <span class=n>os</span><span class=o>.</span><span class=n>unlink</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>            <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>                <span class=k>pass</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=k>del</span> <span class=n>registry</span><span class=p>[</span><span class=n>file_id</span><span class=p>]</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>TEMP_FILES_REGISTRY</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>                <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>registry</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.create_response_with_files class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_response_with_files</span><span class=p>(</span><span class=n>processed</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Create JSON response with file downloads.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>processed</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>Processed result from process_result().</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>Response dictionary with file IDs and metadata.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\__init__.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><span class=k>def</span><span class=w> </span><span class=nf>create_response_with_files</span><span class=p>(</span><span class=n>processed</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Create JSON response with file downloads.</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>    Args:</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>        processed: Processed result from process_result().</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>    Returns:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        Response dictionary with file IDs and metadata.</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>    <span class=n>response</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;success&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;result_type&quot;</span><span class=p>:</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]}</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>    <span class=k>if</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;download&#39;</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>        <span class=n>file_id</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>        <span class=n>register_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>,</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>],</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>])</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;file_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>file_id</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>]</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>    <span class=k>elif</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;downloads&#39;</span><span class=p>:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>        <span class=n>files</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;files&#39;</span><span class=p>]:</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>            <span class=n>file_id</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>            <span class=n>register_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>,</span> <span class=n>f</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>])</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>            <span class=n>files</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                <span class=s1>&#39;file_id&#39;</span><span class=p>:</span> <span class=n>file_id</span><span class=p>,</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>                <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>f</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>]</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>            <span class=p>})</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;files&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>files</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=k>elif</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;multiple&#39;</span><span class=p>:</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>        <span class=n>outputs</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>        <span class=k>for</span> <span class=n>output</span> <span class=ow>in</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;outputs&#39;</span><span class=p>]:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>            <span class=n>output_response</span> <span class=o>=</span> <span class=n>create_response_with_files</span><span class=p>(</span><span class=n>output</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>            <span class=n>output_response</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s1>&#39;success&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>            <span class=n>outputs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>output_response</span><span class=p>)</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;outputs&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>outputs</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>    <span class=k>elif</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;table&#39;</span><span class=p>:</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;headers&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;headers&#39;</span><span class=p>]</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;rows&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;rows&#39;</span><span class=p>]</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>        <span class=n>response</span><span class=p>[</span><span class=s1>&#39;result&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>processed</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>]</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>    <span class=k>return</span> <span class=n>response</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.get_temp_file class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Get temp file info from registry.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>file_id</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Unique identifier for the file.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=str>str</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Dictionary with 'path' and 'filename' keys, or None if not found.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\__init__.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span>
<span class=normal><a href=#__codelineno-0-85>85</a></span>
<span class=normal><a href=#__codelineno-0-86>86</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=k>def</span><span class=w> </span><span class=nf>get_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get temp file info from registry.</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>    Args:</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        file_id: Unique identifier for the file.</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>    Returns:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>        Dictionary with &#39;path&#39; and &#39;filename&#39; keys, or None if not found.</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>TEMP_FILES_REGISTRY</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>TEMP_FILES_REGISTRY</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>            <span class=n>registry</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>        <span class=k>return</span> <span class=n>registry</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>file_id</span><span class=p>)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>    <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.handle_form_submission class="doc doc-heading"> <code class="highlight language-python"><span class=n>handle_form_submission</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>func</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> </h3> <div class="doc doc-contents "> <p>Handle form submission for any function.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>request</code> </td> <td> <code><span title=fastapi.Request>Request</span></code> </td> <td> <div class=doc-md-description> <p>FastAPI request object.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>func</code> </td> <td> <code><span title=typing.Callable>Callable</span></code> </td> <td> <div class=doc-md-description> <p>Function to call with validated parameters.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>params</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <a class="autorefs autorefs-internal" title="ParamInfo


  
      dataclass
   (func_to_web.analyze_function.ParamInfo)" href=#func_to_web.analyze_function.ParamInfo>ParamInfo</a>]</code> </td> <td> <div class=doc-md-description> <p>Parameter metadata from analyze().</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=fastapi.responses.JSONResponse>JSONResponse</span></code> </td> <td> <div class=doc-md-description> <p>JSON response with result or error.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\__init__.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>handle_form_submission</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>func</span><span class=p>:</span> <span class=n>Callable</span><span class=p>,</span> <span class=n>params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>ParamInfo</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>JSONResponse</span><span class=p>:</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Handle form submission for any function.</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>    Args:</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>        request: FastAPI request object.</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>        func: Function to call with validated parameters.</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>        params: Parameter metadata from analyze().</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>    Returns:</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><span class=sd>        JSON response with result or error.</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>        <span class=n>form_data</span> <span class=o>=</span> <span class=k>await</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>()</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=n>data</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>form_data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=s1>&#39;filename&#39;</span><span class=p>):</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                <span class=n>suffix</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>value</span><span class=o>.</span><span class=n>filename</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                <span class=n>data</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=k>await</span> <span class=n>save_uploaded_file</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>suffix</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                <span class=n>data</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>        <span class=n>validated</span> <span class=o>=</span> <span class=n>validate_params</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>        <span class=k>if</span> <span class=n>inspect</span><span class=o>.</span><span class=n>iscoroutinefunction</span><span class=p>(</span><span class=n>func</span><span class=p>):</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>            <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>func</span><span class=p>(</span><span class=o>**</span><span class=n>validated</span><span class=p>)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=n>result</span> <span class=o>=</span> <span class=n>func</span><span class=p>(</span><span class=o>**</span><span class=n>validated</span><span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>        <span class=n>processed</span> <span class=o>=</span> <span class=n>process_result</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>create_response_with_files</span><span class=p>(</span><span class=n>processed</span><span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>        <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>        <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>({</span><span class=s2>&quot;success&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)},</span> <span class=n>status_code</span><span class=o>=</span><span class=mi>400</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.register_temp_file class="doc doc-heading"> <code class="highlight language-python"><span class=n>register_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Register a temp file for download.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>file_id</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Unique identifier for the file.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>File system path to the temporary file.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>filename</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Original filename for download.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\__init__.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=k>def</span><span class=w> </span><span class=nf>register_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>filename</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Register a temp file for download.</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>    Args:</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>        file_id: Unique identifier for the file.</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>        path: File system path to the temporary file.</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>        filename: Original filename for download.</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>        <span class=k>if</span> <span class=n>TEMP_FILES_REGISTRY</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>TEMP_FILES_REGISTRY</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>                <span class=n>registry</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>            <span class=n>registry</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>        <span class=n>registry</span><span class=p>[</span><span class=n>file_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=n>path</span><span class=p>,</span> <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>filename</span><span class=p>}</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>TEMP_FILES_REGISTRY</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>registry</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>    <span class=k>except</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=k>pass</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.run class="doc doc-heading"> <code class="highlight language-python"><span class=n>run</span><span class=p>(</span><span class=n>func_or_list</span><span class=p>,</span> <span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>8000</span><span class=p>,</span> <span class=n>auth</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>secret_key</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>template_dir</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>root_path</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>fastapi_config</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Generate and run a web UI for one or more Python functions.</p> <p>Single function mode: Creates a form at root (/) for the function. Multiple functions mode: Creates an index page with links to individual function forms.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>func_or_list</code> </td> <td> <code><span title=typing.Callable>Callable</span>[..., <span title=typing.Any>Any</span>] | <span title=list>list</span>[<span title=typing.Callable>Callable</span>[..., <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <p>A single function or list of functions to wrap.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>host</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Server host address (default: "0.0.0.0").</p> </div> </td> <td> <code>&#39;0.0.0.0&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>port</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Server port (default: 8000).</p> </div> </td> <td> <code>8000</code> </td> </tr> <tr class=doc-section-item> <td> <code>auth</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=str>str</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Optional dictionary of {username: password} for authentication.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>secret_key</code> </td> <td> <code><span title=str>str</span> | None</code> </td> <td> <div class=doc-md-description> <p>Secret key for session signing (required if auth is used). If None, a random one is generated on startup.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>template_dir</code> </td> <td> <code><span title=str>str</span> | <span title=pathlib.Path>Path</span> | None</code> </td> <td> <div class=doc-md-description> <p>Optional custom template directory.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>root_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Prefix for the API path (useful for reverse proxies).</p> </div> </td> <td> <code>&#39;&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>fastapi_config</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Optional dictionary with extra arguments for FastAPI app (e.g. {'title': 'My App', 'version': '1.0.0'}).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>**kwargs</code> </td> <td> </td> <td> <div class=doc-md-description> <p>Extra options passed directly to <code>uvicorn.Config</code>. Examples: <code>ssl_keyfile</code>, <code>ssl_certfile</code>, <code>workers</code>, <code>log_level</code>.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=FileNotFoundError>FileNotFoundError</span></code> </td> <td> <div class=doc-md-description> <p>If template directory doesn't exist.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If function parameters use unsupported types.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\__init__.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=k>def</span><span class=w> </span><span class=nf>run</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>    <span class=n>func_or_list</span><span class=p>:</span> <span class=n>Callable</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=nb>list</span><span class=p>[</span><span class=n>Callable</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=n>Any</span><span class=p>]],</span> 
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>    <span class=n>host</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;0.0.0.0&quot;</span><span class=p>,</span> 
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>    <span class=n>port</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>8000</span><span class=p>,</span> 
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>    <span class=n>auth</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>    <span class=n>secret_key</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>    <span class=n>template_dir</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=n>Path</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>    <span class=n>root_path</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>    <span class=n>fastapi_config</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>    <span class=o>**</span><span class=n>kwargs</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Generate and run a web UI for one or more Python functions.</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>    Single function mode: Creates a form at root (/) for the function.</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a><span class=sd>    Multiple functions mode: Creates an index page with links to individual function forms.</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>    Args:</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>        func_or_list: A single function or list of functions to wrap.</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a><span class=sd>        host: Server host address (default: &quot;0.0.0.0&quot;).</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=sd>        port: Server port (default: 8000).</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><span class=sd>        auth: Optional dictionary of {username: password} for authentication.</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><span class=sd>        secret_key: Secret key for session signing (required if auth is used). </span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=sd>                    If None, a random one is generated on startup.</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a><span class=sd>        template_dir: Optional custom template directory.</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><span class=sd>        root_path: Prefix for the API path (useful for reverse proxies).</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>        fastapi_config: Optional dictionary with extra arguments for FastAPI app </span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=sd>                        (e.g. {&#39;title&#39;: &#39;My App&#39;, &#39;version&#39;: &#39;1.0.0&#39;}).</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a><span class=sd>        **kwargs: Extra options passed directly to `uvicorn.Config`.</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>                  Examples: `ssl_keyfile`, `ssl_certfile`, `workers`, `log_level`.</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=sd>    Raises:</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><span class=sd>        FileNotFoundError: If template directory doesn&#39;t exist.</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=sd>        TypeError: If function parameters use unsupported types.</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>    <span class=n>funcs</span> <span class=o>=</span> <span class=n>func_or_list</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>func_or_list</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=k>else</span> <span class=p>[</span><span class=n>func_or_list</span><span class=p>]</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>    <span class=c1># 1. Prepare FastAPI configuration</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>    <span class=n>app_kwargs</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;root_path&quot;</span><span class=p>:</span> <span class=n>root_path</span><span class=p>}</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>    <span class=k>if</span> <span class=n>fastapi_config</span><span class=p>:</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>        <span class=n>conf</span> <span class=o>=</span> <span class=n>fastapi_config</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>        <span class=k>if</span> <span class=s2>&quot;root_path&quot;</span> <span class=ow>in</span> <span class=n>conf</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=n>conf</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;root_path&quot;</span><span class=p>)</span> 
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>        <span class=n>app_kwargs</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>conf</span><span class=p>)</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>    <span class=c1># Instantiate FastAPI with combined config</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>    <span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=o>**</span><span class=n>app_kwargs</span><span class=p>)</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>    <span class=k>if</span> <span class=n>template_dir</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>        <span class=n>template_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)</span><span class=o>.</span><span class=n>parent</span> <span class=o>/</span> <span class=s2>&quot;templates&quot;</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>        <span class=n>template_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>template_dir</span><span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>template_dir</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>        <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>            <span class=sa>f</span><span class=s2>&quot;Template directory &#39;</span><span class=si>{</span><span class=n>template_dir</span><span class=si>}</span><span class=s2>&#39; not found.&quot;</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=p>)</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>    <span class=n>templates</span> <span class=o>=</span> <span class=n>Jinja2Templates</span><span class=p>(</span><span class=n>directory</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>template_dir</span><span class=p>))</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>    <span class=n>app</span><span class=o>.</span><span class=n>mount</span><span class=p>(</span><span class=s2>&quot;/static&quot;</span><span class=p>,</span> <span class=n>StaticFiles</span><span class=p>(</span><span class=n>directory</span><span class=o>=</span><span class=n>template_dir</span> <span class=o>/</span> <span class=s2>&quot;static&quot;</span><span class=p>),</span> <span class=n>name</span><span class=o>=</span><span class=s2>&quot;static&quot;</span><span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>    <span class=c1># Download endpoint for streaming files</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>    <span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/download/</span><span class=si>{file_id}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>download_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=n>file_info</span> <span class=o>=</span> <span class=n>get_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>)</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>file_info</span><span class=p>:</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>            <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;File not found&quot;</span><span class=p>},</span> <span class=n>status_code</span><span class=o>=</span><span class=mi>404</span><span class=p>)</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=n>path</span> <span class=o>=</span> <span class=n>file_info</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>]</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>        <span class=n>filename</span> <span class=o>=</span> <span class=n>file_info</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>]</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>            <span class=n>cleanup_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>)</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>            <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;File expired&quot;</span><span class=p>},</span> <span class=n>status_code</span><span class=o>=</span><span class=mi>404</span><span class=p>)</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>FastAPIFileResponse</span><span class=p>(</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>            <span class=n>path</span><span class=o>=</span><span class=n>path</span><span class=p>,</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>            <span class=n>filename</span><span class=o>=</span><span class=n>filename</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>            <span class=n>media_type</span><span class=o>=</span><span class=s1>&#39;application/octet-stream&#39;</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>        <span class=p>)</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>        <span class=c1># Cleanup after sending</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>        <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>cleanup</span><span class=p>():</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>            <span class=n>cleanup_temp_file</span><span class=p>(</span><span class=n>file_id</span><span class=p>)</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>        <span class=n>response</span><span class=o>.</span><span class=n>background</span> <span class=o>=</span> <span class=n>cleanup</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>        <span class=k>return</span> <span class=n>response</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>    <span class=c1># Single function mode</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>funcs</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>        <span class=n>func</span> <span class=o>=</span> <span class=n>funcs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>        <span class=n>params</span> <span class=o>=</span> <span class=n>analyze</span><span class=p>(</span><span class=n>func</span><span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>        <span class=n>func_name</span> <span class=o>=</span> <span class=n>func</span><span class=o>.</span><span class=vm>__name__</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=p>,</span> <span class=s1>&#39; &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>title</span><span class=p>()</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>        <span class=n>description</span> <span class=o>=</span> <span class=n>inspect</span><span class=o>.</span><span class=n>getdoc</span><span class=p>(</span><span class=n>func</span><span class=p>)</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>        <span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>        <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>form</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>            <span class=n>fields</span> <span class=o>=</span> <span class=n>build_form_fields</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>            <span class=k>return</span> <span class=n>templates</span><span class=o>.</span><span class=n>TemplateResponse</span><span class=p>(</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>                <span class=s2>&quot;form.html&quot;</span><span class=p>,</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>                <span class=p>{</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>                    <span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request</span><span class=p>,</span> 
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>                    <span class=s2>&quot;title&quot;</span><span class=p>:</span> <span class=n>func_name</span><span class=p>,</span> 
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>                    <span class=s2>&quot;description&quot;</span><span class=p>:</span> <span class=n>description</span><span class=p>,</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>                    <span class=s2>&quot;fields&quot;</span><span class=p>:</span> <span class=n>fields</span><span class=p>,</span> 
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>                    <span class=s2>&quot;submit_url&quot;</span><span class=p>:</span> <span class=s2>&quot;/submit&quot;</span><span class=p>,</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>                    <span class=s2>&quot;show_back_button&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>                    <span class=s2>&quot;has_auth&quot;</span><span class=p>:</span> <span class=nb>bool</span><span class=p>(</span><span class=n>auth</span><span class=p>)</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>                <span class=p>}</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>            <span class=p>)</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>        <span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/submit&quot;</span><span class=p>)</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>submit</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>            <span class=k>return</span> <span class=k>await</span> <span class=n>handle_form_submission</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>func</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>    <span class=c1># Multiple functions mode</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>        <span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>        <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>index</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>            <span class=n>tools</span> <span class=o>=</span> <span class=p>[{</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>                <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>f</span><span class=o>.</span><span class=vm>__name__</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=p>,</span> <span class=s1>&#39; &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>title</span><span class=p>(),</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>                <span class=s2>&quot;path&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>f</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>            <span class=p>}</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>funcs</span><span class=p>]</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>            <span class=k>return</span> <span class=n>templates</span><span class=o>.</span><span class=n>TemplateResponse</span><span class=p>(</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>                <span class=s2>&quot;index.html&quot;</span><span class=p>,</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>                <span class=p>{</span><span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request</span><span class=p>,</span> <span class=s2>&quot;tools&quot;</span><span class=p>:</span> <span class=n>tools</span><span class=p>,</span> <span class=s2>&quot;has_auth&quot;</span><span class=p>:</span> <span class=nb>bool</span><span class=p>(</span><span class=n>auth</span><span class=p>)}</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>            <span class=p>)</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>        <span class=k>for</span> <span class=n>func</span> <span class=ow>in</span> <span class=n>funcs</span><span class=p>:</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>            <span class=n>params</span> <span class=o>=</span> <span class=n>analyze</span><span class=p>(</span><span class=n>func</span><span class=p>)</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a>            <span class=n>func_name</span> <span class=o>=</span> <span class=n>func</span><span class=o>.</span><span class=vm>__name__</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=p>,</span> <span class=s1>&#39; &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>title</span><span class=p>()</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>            <span class=n>description</span> <span class=o>=</span> <span class=n>inspect</span><span class=o>.</span><span class=n>getdoc</span><span class=p>(</span><span class=n>func</span><span class=p>)</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a>            <span class=n>route</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;/</span><span class=si>{</span><span class=n>func</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>            <span class=n>submit_route</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>route</span><span class=si>}</span><span class=s2>/submit&quot;</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>            <span class=k>def</span><span class=w> </span><span class=nf>make_form_handler</span><span class=p>(</span><span class=n>title</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>prms</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>ParamInfo</span><span class=p>],</span> <span class=n>desc</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span> <span class=n>submit_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>                <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>form_view</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>                    <span class=n>flds</span> <span class=o>=</span> <span class=n>build_form_fields</span><span class=p>(</span><span class=n>prms</span><span class=p>)</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>                    <span class=k>return</span> <span class=n>templates</span><span class=o>.</span><span class=n>TemplateResponse</span><span class=p>(</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>                        <span class=s2>&quot;form.html&quot;</span><span class=p>,</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a>                        <span class=p>{</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>                            <span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request</span><span class=p>,</span> 
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>                            <span class=s2>&quot;title&quot;</span><span class=p>:</span> <span class=n>title</span><span class=p>,</span> 
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>                            <span class=s2>&quot;description&quot;</span><span class=p>:</span> <span class=n>desc</span><span class=p>,</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>                            <span class=s2>&quot;fields&quot;</span><span class=p>:</span> <span class=n>flds</span><span class=p>,</span> 
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>                            <span class=s2>&quot;submit_url&quot;</span><span class=p>:</span> <span class=n>submit_path</span><span class=p>,</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>                            <span class=s2>&quot;show_back_button&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>                            <span class=s2>&quot;has_auth&quot;</span><span class=p>:</span> <span class=nb>bool</span><span class=p>(</span><span class=n>auth</span><span class=p>)</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>                        <span class=p>}</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>                    <span class=p>)</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>                <span class=k>return</span> <span class=n>form_view</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>            <span class=k>def</span><span class=w> </span><span class=nf>make_submit_handler</span><span class=p>(</span><span class=n>fn</span><span class=p>:</span> <span class=n>Callable</span><span class=p>,</span> <span class=n>prms</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>ParamInfo</span><span class=p>]):</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>                <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>submit_view</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>                    <span class=k>return</span> <span class=k>await</span> <span class=n>handle_form_submission</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>fn</span><span class=p>,</span> <span class=n>prms</span><span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>                <span class=k>return</span> <span class=n>submit_view</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>            <span class=n>app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>route</span><span class=p>)(</span><span class=n>make_form_handler</span><span class=p>(</span><span class=n>func_name</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>description</span><span class=p>,</span> <span class=n>submit_route</span><span class=p>))</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>            <span class=n>app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>submit_route</span><span class=p>)(</span><span class=n>make_submit_handler</span><span class=p>(</span><span class=n>func</span><span class=p>,</span> <span class=n>params</span><span class=p>))</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>    <span class=k>if</span> <span class=n>auth</span><span class=p>:</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=n>key</span> <span class=o>=</span> <span class=n>secret_key</span> <span class=ow>or</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_hex</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>        <span class=c1># 1. Define Auth Middleware (INNER)</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>        <span class=nd>@app</span><span class=o>.</span><span class=n>middleware</span><span class=p>(</span><span class=s2>&quot;http&quot;</span><span class=p>)</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>        <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>auth_middleware</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>call_next</span><span class=p>):</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>            <span class=n>path</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>url</span><span class=o>.</span><span class=n>path</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>            <span class=c1># Allow public paths: login page, auth endpoint, and static assets</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>            <span class=k>if</span> <span class=n>path</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;/login&quot;</span><span class=p>,</span> <span class=s2>&quot;/auth&quot;</span><span class=p>]</span> <span class=ow>or</span> <span class=n>path</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;/static&quot;</span><span class=p>):</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>                <span class=k>return</span> <span class=k>await</span> <span class=n>call_next</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>            <span class=c1># Check for valid session</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;user&quot;</span><span class=p>):</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>                <span class=c1># If API call (AJAX), return 401</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>                <span class=k>if</span> <span class=s2>&quot;application/json&quot;</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;accept&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>):</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>                     <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>({</span><span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;Unauthorized&quot;</span><span class=p>},</span> <span class=n>status_code</span><span class=o>=</span><span class=mi>401</span><span class=p>)</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>                <span class=c1># If browser navigation, redirect to login</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>                <span class=k>return</span> <span class=n>RedirectResponse</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=s2>&quot;/login&quot;</span><span class=p>)</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>            <span class=k>return</span> <span class=k>await</span> <span class=n>call_next</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>        <span class=c1># 2. Add SessionMiddleware (OUTER - runs first)</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>        <span class=c1># https_only=False is safer for local dev/proxies. </span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>        <span class=n>app</span><span class=o>.</span><span class=n>add_middleware</span><span class=p>(</span><span class=n>SessionMiddleware</span><span class=p>,</span> <span class=n>secret_key</span><span class=o>=</span><span class=n>key</span><span class=p>,</span> <span class=n>https_only</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>        <span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/login&quot;</span><span class=p>)</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>        <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>login_page</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>            <span class=c1># If already logged in, go home</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>            <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;user&quot;</span><span class=p>):</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>                <span class=k>return</span> <span class=n>RedirectResponse</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>            <span class=k>return</span> <span class=n>templates</span><span class=o>.</span><span class=n>TemplateResponse</span><span class=p>(</span><span class=s2>&quot;login.html&quot;</span><span class=p>,</span> <span class=p>{</span><span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request</span><span class=p>})</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>        <span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/auth&quot;</span><span class=p>)</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>        <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>authenticate</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>                <span class=n>form</span> <span class=o>=</span> <span class=k>await</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>()</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>                <span class=n>username</span> <span class=o>=</span> <span class=n>form</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;username&quot;</span><span class=p>)</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>                <span class=n>password</span> <span class=o>=</span> <span class=n>form</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;password&quot;</span><span class=p>)</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>                <span class=k>if</span> <span class=n>username</span> <span class=ow>in</span> <span class=n>auth</span><span class=p>:</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a>                    <span class=c1># Safe comparison against Timing Attacks</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>                    <span class=k>if</span> <span class=n>secrets</span><span class=o>.</span><span class=n>compare_digest</span><span class=p>(</span><span class=n>auth</span><span class=p>[</span><span class=n>username</span><span class=p>],</span> <span class=n>password</span><span class=p>):</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>                        <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s2>&quot;user&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>username</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a>                        <span class=k>return</span> <span class=n>RedirectResponse</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=s2>&quot;/&quot;</span><span class=p>,</span> <span class=n>status_code</span><span class=o>=</span><span class=mi>303</span><span class=p>)</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>                <span class=k>return</span> <span class=n>templates</span><span class=o>.</span><span class=n>TemplateResponse</span><span class=p>(</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a>                    <span class=s2>&quot;login.html&quot;</span><span class=p>,</span> 
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a>                    <span class=p>{</span><span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request</span><span class=p>,</span> <span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;Invalid credentials&quot;</span><span class=p>}</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a>                <span class=p>)</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>            <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>                <span class=k>return</span> <span class=n>templates</span><span class=o>.</span><span class=n>TemplateResponse</span><span class=p>(</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>                    <span class=s2>&quot;login.html&quot;</span><span class=p>,</span> 
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>                    <span class=p>{</span><span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request</span><span class=p>,</span> <span class=s2>&quot;error&quot;</span><span class=p>:</span> <span class=s2>&quot;Login failed&quot;</span><span class=p>}</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>                <span class=p>)</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>        <span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/logout&quot;</span><span class=p>)</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>        <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>logout</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>            <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>            <span class=k>return</span> <span class=n>RedirectResponse</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=s2>&quot;/login&quot;</span><span class=p>)</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>    <span class=c1># 2. Prepare Uvicorn configuration</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>    <span class=n>uvicorn_params</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>        <span class=s2>&quot;host&quot;</span><span class=p>:</span> <span class=n>host</span><span class=p>,</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>        <span class=s2>&quot;port&quot;</span><span class=p>:</span> <span class=n>port</span><span class=p>,</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>        <span class=s2>&quot;reload&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>        <span class=s2>&quot;limit_concurrency&quot;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>        <span class=s2>&quot;limit_max_requests&quot;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>,</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>        <span class=s2>&quot;timeout_keep_alive&quot;</span><span class=p>:</span> <span class=mi>30</span><span class=p>,</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>        <span class=s2>&quot;h11_max_incomplete_event_size&quot;</span><span class=p>:</span> <span class=mi>16</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>    <span class=p>}</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>    <span class=k>if</span> <span class=s2>&quot;root_path&quot;</span> <span class=ow>in</span> <span class=n>kwargs</span><span class=p>:</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>        <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;root_path&quot;</span><span class=p>)</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>    <span class=n>uvicorn_params</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>    <span class=n>config</span> <span class=o>=</span> <span class=n>uvicorn</span><span class=o>.</span><span class=n>Config</span><span class=p>(</span><span class=n>app</span><span class=p>,</span> <span class=o>**</span><span class=n>uvicorn_params</span><span class=p>)</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>    <span class=n>server</span> <span class=o>=</span> <span class=n>uvicorn</span><span class=o>.</span><span class=n>Server</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>server</span><span class=o>.</span><span class=n>serve</span><span class=p>())</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.save_uploaded_file class="doc doc-heading"> <code class="highlight language-python"><span class=n>save_uploaded_file</span><span class=p>(</span><span class=n>uploaded_file</span><span class=p>,</span> <span class=n>suffix</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> </h3> <div class="doc doc-contents "> <p>Save an uploaded file to a temporary location.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>uploaded_file</code> </td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>The uploaded file object from FastAPI.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>suffix</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>File extension to use for the temp file.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Path to the saved temporary file.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\__init__.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>save_uploaded_file</span><span class=p>(</span><span class=n>uploaded_file</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=n>suffix</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Save an uploaded file to a temporary location.</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>    Args:</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>        uploaded_file: The uploaded file object from FastAPI.</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>        suffix: File extension to use for the temp file.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>    Returns:</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>        Path to the saved temporary file.</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>    <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>NamedTemporaryFile</span><span class=p>(</span><span class=n>delete</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=n>suffix</span><span class=p>,</span> <span class=n>buffering</span><span class=o>=</span><span class=n>FILE_BUFFER_SIZE</span><span class=p>)</span> <span class=k>as</span> <span class=n>tmp</span><span class=p>:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>        <span class=k>while</span> <span class=n>chunk</span> <span class=o>:=</span> <span class=k>await</span> <span class=n>uploaded_file</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>CHUNK_SIZE</span><span class=p>):</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>            <span class=n>tmp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>        <span class=k>return</span> <span class=n>tmp</span><span class=o>.</span><span class=n>name</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=func_to_web.types class="doc doc-heading"> <code>func_to_web.types</code> </h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h3 id=func_to_web.types.FileResponse class="doc doc-heading"> <code>FileResponse</code> </h3> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=pydantic.BaseModel>BaseModel</span></code></p> <p>Model for file response.</p> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\types.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=k>class</span><span class=w> </span><span class=nc>FileResponse</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Model for file response.&quot;&quot;&quot;</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=n>data</span><span class=p>:</span> <span class=nb>bytes</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=n>filename</span><span class=p>:</span> <span class=nb>str</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=func_to_web.analyze_function class="doc doc-heading"> <code>func_to_web.analyze_function</code> </h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h3 id=func_to_web.analyze_function.ParamInfo class="doc doc-heading"> <code>ParamInfo</code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small> </span> </h3> <div class="doc doc-contents "> <p>Metadata about a function parameter extracted by analyze().</p> <p>This dataclass stores all the information needed to generate form fields, validate input, and call the function with the correct parameters.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.type>type</span></code></td> <td> <code><span title=func_to_web.analyze_function.ParamInfo.type>type</span></code> </td> <td> <div class=doc-md-description> <p>The base Python type of the parameter. Must be one of: int, float, str, bool, date, or time. Example: int, str, date</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.default>default</span></code></td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>The default value specified in the parameter. - None if the parameter has no default - The actual default value if specified (e.g., 42, "hello", True) - Independent of is_optional (a parameter can be optional with or without a default) Example: For <code>age: int = 25</code>, default is 25 Example: For <code>name: str</code>, default is None</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.field_info>field_info</span></code></td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>Additional metadata from Pydantic Field or Literal. - For Annotated types: Contains the Field object with constraints (e.g., Field(ge=0, le=100) for numeric bounds, Field(min_length=3) for strings) - For Literal types: Contains the Literal type with valid options - None for basic types without constraints Example: Field(ge=18, le=100) for age constraints Example: Literal['light', 'dark'] for dropdown options</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.dynamic_func>dynamic_func</span></code></td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>Function for dynamic Literal options. - Only set for Literal[callable] type hints - Called at runtime to generate dropdown options dynamically - Returns a list, tuple, or single value - None for static Literals or non-Literal types Example: A function that returns database options</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.is_optional>is_optional</span></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the parameter type includes None. - True for Type | None or Union[Type, None] syntax - False for regular required parameters (even if they have a default) - Affects UI: optional fields get a toggle switch to enable/disable - Default: False Example: <code>name: str | None</code> has is_optional=True Example: <code>age: int = 25</code> has is_optional=False (even with default)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.optional_enabled>optional_enabled</span></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Initial state of optional toggle. - Only relevant when is_optional=True - True: toggle starts enabled (field active) - False: toggle starts disabled (field inactive, sends None) - Determined by: explicit marker &gt; default value &gt; False - Default: False Example: <code>name: str | OptionalEnabled</code> starts enabled Example: <code>name: str | OptionalDisabled</code> starts disabled Example: <code>name: str | None = "John"</code> starts enabled (has default) Example: <code>name: str | None</code> starts disabled (no default)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.is_list>is_list</span></code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether the parameter is a list type. - True for list[Type] syntax - False for regular parameters - When True, 'type' contains the item type, not list - Default: False</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.list_field_info>list_field_info</span></code></td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>Metadata for the list itself (min_items, max_items). - Only relevant when is_list=True - Contains Field constraints for the list container - None if no list-level constraints Example: Field(min_items=2, max_items=5)</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title=func_to_web.analyze_function.ParamInfo.enum_type>enum_type</span></code></td> <td> <code>None</code> </td> <td> <div class=doc-md-description> <p>The original Enum type if parameter was an Enum. - None for non-Enum parameters - Stored to convert string back to Enum in validation - Example: For <code>color: Color</code>, stores the Color Enum class</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\analyze_function.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-14>14</a></span>
<span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span>
<span class=normal><a href=#__codelineno-0-36>36</a></span>
<span class=normal><a href=#__codelineno-0-37>37</a></span>
<span class=normal><a href=#__codelineno-0-38>38</a></span>
<span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span>
<span class=normal><a href=#__codelineno-0-62>62</a></span>
<span class=normal><a href=#__codelineno-0-63>63</a></span>
<span class=normal><a href=#__codelineno-0-64>64</a></span>
<span class=normal><a href=#__codelineno-0-65>65</a></span>
<span class=normal><a href=#__codelineno-0-66>66</a></span>
<span class=normal><a href=#__codelineno-0-67>67</a></span>
<span class=normal><a href=#__codelineno-0-68>68</a></span>
<span class=normal><a href=#__codelineno-0-69>69</a></span>
<span class=normal><a href=#__codelineno-0-70>70</a></span>
<span class=normal><a href=#__codelineno-0-71>71</a></span>
<span class=normal><a href=#__codelineno-0-72>72</a></span>
<span class=normal><a href=#__codelineno-0-73>73</a></span>
<span class=normal><a href=#__codelineno-0-74>74</a></span>
<span class=normal><a href=#__codelineno-0-75>75</a></span>
<span class=normal><a href=#__codelineno-0-76>76</a></span>
<span class=normal><a href=#__codelineno-0-77>77</a></span>
<span class=normal><a href=#__codelineno-0-78>78</a></span>
<span class=normal><a href=#__codelineno-0-79>79</a></span>
<span class=normal><a href=#__codelineno-0-80>80</a></span>
<span class=normal><a href=#__codelineno-0-81>81</a></span>
<span class=normal><a href=#__codelineno-0-82>82</a></span>
<span class=normal><a href=#__codelineno-0-83>83</a></span>
<span class=normal><a href=#__codelineno-0-84>84</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=nd>@dataclass</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=k>class</span><span class=w> </span><span class=nc>ParamInfo</span><span class=p>:</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Metadata about a function parameter extracted by analyze().</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>    This dataclass stores all the information needed to generate form fields,</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    validate input, and call the function with the correct parameters.</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>    Attributes:</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>        type: The base Python type of the parameter. Must be one of:</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>            int, float, str, bool, date, or time.</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=sd>            Example: int, str, date</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>        default: The default value specified in the parameter.</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>            - None if the parameter has no default</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>            - The actual default value if specified (e.g., 42, &quot;hello&quot;, True)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>            - Independent of is_optional (a parameter can be optional with or without a default)</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>            Example: For `age: int = 25`, default is 25</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>            Example: For `name: str`, default is None</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>        field_info: Additional metadata from Pydantic Field or Literal.</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>            - For Annotated types: Contains the Field object with constraints</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>              (e.g., Field(ge=0, le=100) for numeric bounds, Field(min_length=3) for strings)</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=sd>            - For Literal types: Contains the Literal type with valid options</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>            - None for basic types without constraints</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>            Example: Field(ge=18, le=100) for age constraints</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>            Example: Literal[&#39;light&#39;, &#39;dark&#39;] for dropdown options</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=sd>        dynamic_func: Function for dynamic Literal options.</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>            - Only set for Literal[callable] type hints</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>            - Called at runtime to generate dropdown options dynamically</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=sd>            - Returns a list, tuple, or single value</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=sd>            - None for static Literals or non-Literal types</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>            Example: A function that returns database options</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=sd>        is_optional: Whether the parameter type includes None.</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>            - True for Type | None or Union[Type, None] syntax</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>            - False for regular required parameters (even if they have a default)</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>            - Affects UI: optional fields get a toggle switch to enable/disable</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>            - Default: False</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>            Example: `name: str | None` has is_optional=True</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>            Example: `age: int = 25` has is_optional=False (even with default)</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>        optional_enabled: Initial state of optional toggle.</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>            - Only relevant when is_optional=True</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>            - True: toggle starts enabled (field active)</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>            - False: toggle starts disabled (field inactive, sends None)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>            - Determined by: explicit marker &gt; default value &gt; False</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=sd>            - Default: False</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>            Example: `name: str | OptionalEnabled` starts enabled</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>            Example: `name: str | OptionalDisabled` starts disabled</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><span class=sd>            Example: `name: str | None = &quot;John&quot;` starts enabled (has default)</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>            Example: `name: str | None` starts disabled (no default)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>        is_list: Whether the parameter is a list type.</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><span class=sd>            - True for list[Type] syntax</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>            - False for regular parameters</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>            - When True, &#39;type&#39; contains the item type, not list</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>            - Default: False</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>        list_field_info: Metadata for the list itself (min_items, max_items).</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>            - Only relevant when is_list=True</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>            - Contains Field constraints for the list container</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>            - None if no list-level constraints</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>            Example: Field(min_items=2, max_items=5)</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>        enum_type: The original Enum type if parameter was an Enum.</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>            - None for non-Enum parameters</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>            - Stored to convert string back to Enum in validation</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>            - Example: For `color: Color`, stores the Color Enum class</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>    <span class=nb>type</span><span class=p>:</span> <span class=nb>type</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>    <span class=n>default</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>    <span class=n>field_info</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>    <span class=n>dynamic_func</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>    <span class=n>is_optional</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>    <span class=n>optional_enabled</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>    <span class=n>is_list</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>    <span class=n>list_field_info</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>    <span class=n>enum_type</span><span class=p>:</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.analyze_function.analyze class="doc doc-heading"> <code class="highlight language-python"><span class=n>analyze</span><span class=p>(</span><span class=n>func</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Analyze a function's signature and extract parameter metadata.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>func</code> </td> <td> <code><span title=typing.Callable>Callable</span>[..., <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The function to analyze.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <a class="autorefs autorefs-internal" title="ParamInfo


  
      dataclass
   (func_to_web.analyze_function.ParamInfo)" href=#func_to_web.analyze_function.ParamInfo>ParamInfo</a>]</code> </td> <td> <div class=doc-md-description> <p>Mapping of parameter names to ParamInfo objects.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If parameter type is not supported.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If list has no type parameter.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If list item type is not supported.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If list of Literal is used (conceptually confusing).</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If list default is not a list.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If list default items have wrong type.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If default value doesn't match Literal options.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If Literal options are invalid.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If Union has multiple non-None types.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If default value type doesn't match parameter type.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\analyze_function.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=k>def</span><span class=w> </span><span class=nf>analyze</span><span class=p>(</span><span class=n>func</span><span class=p>:</span> <span class=n>Callable</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>ParamInfo</span><span class=p>]:</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Analyze a function&#39;s signature and extract parameter metadata.</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    Args:</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>        func: The function to analyze.</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><span class=sd>    Returns:</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><span class=sd>        Mapping of parameter names to ParamInfo objects.</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><span class=sd>    Raises:</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><span class=sd>        TypeError: If parameter type is not supported.</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><span class=sd>        TypeError: If list has no type parameter.</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><span class=sd>        TypeError: If list item type is not supported.</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><span class=sd>        TypeError: If list of Literal is used (conceptually confusing).</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><span class=sd>        TypeError: If list default is not a list.</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><span class=sd>        TypeError: If list default items have wrong type.</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><span class=sd>        ValueError: If default value doesn&#39;t match Literal options.</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><span class=sd>        ValueError: If Literal options are invalid.</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=sd>        ValueError: If Union has multiple non-None types.</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=sd>        ValueError: If default value type doesn&#39;t match parameter type.</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>    <span class=n>result</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>inspect</span><span class=o>.</span><span class=n>signature</span><span class=p>(</span><span class=n>func</span><span class=p>)</span><span class=o>.</span><span class=n>parameters</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=n>default</span> <span class=o>=</span> <span class=kc>None</span> <span class=k>if</span> <span class=n>p</span><span class=o>.</span><span class=n>default</span> <span class=o>==</span> <span class=n>inspect</span><span class=o>.</span><span class=n>Parameter</span><span class=o>.</span><span class=n>empty</span> <span class=k>else</span> <span class=n>p</span><span class=o>.</span><span class=n>default</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=n>t</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>annotation</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=n>f</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=n>list_f</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># Field info for the list itself</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=n>dynamic_func</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>        <span class=n>is_optional</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=n>optional_default_enabled</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># None = auto, True = enabled, False = disabled</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=n>is_list</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>        <span class=n>enum_type</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>        <span class=c1># 1. Extract base type from Annotated (OUTER level)</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>        <span class=c1># This could be constraints for the list itself</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>        <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Annotated</span><span class=p>:</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=n>args</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>            <span class=n>t</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>args</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                <span class=c1># Store this temporarily - we&#39;ll decide if it&#39;s for list or item later</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                <span class=n>list_f</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>        <span class=c1># 2. Check for Union types (including | None syntax) BEFORE list detection</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>        <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=ow>is</span> <span class=n>types</span><span class=o>.</span><span class=n>UnionType</span> <span class=ow>or</span> <span class=nb>str</span><span class=p>(</span><span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>))</span> <span class=o>==</span> <span class=s1>&#39;typing.Union&#39;</span><span class=p>:</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>            <span class=n>union_args</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>            <span class=c1># First pass: detect markers and check for None</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>            <span class=n>has_none</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span> <span class=ow>in</span> <span class=n>union_args</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>            <span class=k>for</span> <span class=n>arg</span> <span class=ow>in</span> <span class=n>union_args</span><span class=p>:</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>                <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>arg</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Annotated</span><span class=p>:</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>                    <span class=n>annotated_args</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>arg</span><span class=p>)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>                    <span class=c1># Check if this is Annotated[None, Marker]</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>                    <span class=k>if</span> <span class=n>annotated_args</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>is</span> <span class=nb>type</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>annotated_args</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>                        <span class=k>for</span> <span class=n>marker</span> <span class=ow>in</span> <span class=n>annotated_args</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>                            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>marker</span><span class=p>,</span> <span class=n>_OptionalEnabledMarker</span><span class=p>):</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>                                <span class=n>optional_default_enabled</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>                                <span class=n>is_optional</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>                            <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>marker</span><span class=p>,</span> <span class=n>_OptionalDisabledMarker</span><span class=p>):</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>                                <span class=n>optional_default_enabled</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>                                <span class=n>is_optional</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>            <span class=c1># Second pass: extract the actual type (not None, not markers)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>            <span class=k>if</span> <span class=n>has_none</span> <span class=ow>or</span> <span class=n>is_optional</span><span class=p>:</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>                <span class=n>is_optional</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>                <span class=n>non_none_types</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>                <span class=k>for</span> <span class=n>arg</span> <span class=ow>in</span> <span class=n>union_args</span><span class=p>:</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>                    <span class=c1># Skip plain None</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>                    <span class=k>if</span> <span class=n>arg</span> <span class=ow>is</span> <span class=nb>type</span><span class=p>(</span><span class=kc>None</span><span class=p>):</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                        <span class=k>continue</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                    <span class=c1># Skip Annotated[None, Marker] (the markers)</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>                    <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>arg</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Annotated</span><span class=p>:</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                        <span class=n>annotated_args</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>arg</span><span class=p>)</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                        <span class=k>if</span> <span class=n>annotated_args</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>is</span> <span class=nb>type</span><span class=p>(</span><span class=kc>None</span><span class=p>):</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>                            <span class=k>continue</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>                    <span class=c1># This is the actual type</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                    <span class=n>non_none_types</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>arg</span><span class=p>)</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>non_none_types</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: Cannot have only None type&quot;</span><span class=p>)</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=n>non_none_types</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: Union with multiple non-None types not supported&quot;</span><span class=p>)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                <span class=c1># Extract the actual type</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                <span class=n>t</span> <span class=o>=</span> <span class=n>non_none_types</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>                <span class=c1># Check again if this is Annotated (for Field constraints)</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Annotated</span><span class=p>:</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                    <span class=n>args</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>                    <span class=n>t</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>args</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>list_f</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                        <span class=n>list_f</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>        <span class=c1># 3. Detect list type</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=ow>is</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>            <span class=n>is_list</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=n>list_args</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>list_args</span><span class=p>:</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: list must have type parameter (e.g., list[int])&quot;</span><span class=p>)</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>            <span class=c1># Extract item type</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>            <span class=n>t</span> <span class=o>=</span> <span class=n>list_args</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>            <span class=c1># Check if item type is Literal (before extracting Annotated)</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>            <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Literal</span><span class=p>:</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: list of Literal not supported&quot;</span><span class=p>)</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>            <span class=c1># 4. Extract Annotated from ITEM type</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>            <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Annotated</span><span class=p>:</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>                <span class=n>args</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>                <span class=n>t</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>                <span class=c1># Check again for Literal after extracting Annotated</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>                <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Literal</span><span class=p>:</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: list of Literal not supported&quot;</span><span class=p>)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>args</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>                    <span class=n>f</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>  <span class=c1># Field constraints for EACH ITEM</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>        <span class=k>elif</span> <span class=n>t</span> <span class=ow>is</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>            <span class=c1># Handle bare &#39;list&#39; without type parameter</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: list must have type parameter (e.g., list[int])&quot;</span><span class=p>)</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>        <span class=c1># If not a list, then list_f is actually the field_info for the item</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>is_list</span> <span class=ow>and</span> <span class=n>list_f</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>            <span class=n>f</span> <span class=o>=</span> <span class=n>list_f</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>            <span class=n>list_f</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=c1># 5. Handle Literal types (dropdowns)</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>        <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>t</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Literal</span><span class=p>:</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>            <span class=n>opts</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>            <span class=c1># Check if opts contains a single callable (dynamic Literal)</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>opts</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>and</span> <span class=nb>callable</span><span class=p>(</span><span class=n>opts</span><span class=p>[</span><span class=mi>0</span><span class=p>]):</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>                <span class=n>dynamic_func</span> <span class=o>=</span> <span class=n>opts</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>                <span class=n>result_value</span> <span class=o>=</span> <span class=n>dynamic_func</span><span class=p>()</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>                <span class=c1># Convert result to tuple properly</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>                <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result_value</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>                    <span class=n>opts</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>result_value</span><span class=p>)</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>                    <span class=n>opts</span> <span class=o>=</span> <span class=p>(</span><span class=n>result_value</span><span class=p>,)</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>            <span class=c1># Validate options</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>            <span class=k>if</span> <span class=n>opts</span><span class=p>:</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>                <span class=n>types_set</span> <span class=o>=</span> <span class=p>{</span><span class=nb>type</span><span class=p>(</span><span class=n>o</span><span class=p>)</span> <span class=k>for</span> <span class=n>o</span> <span class=ow>in</span> <span class=n>opts</span><span class=p>}</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>types_set</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: mixed types in Literal&quot;</span><span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>                <span class=c1># For lists, we can&#39;t validate default against Literal here (it&#39;s a list)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>                <span class=k>if</span> <span class=ow>not</span> <span class=n>is_list</span> <span class=ow>and</span> <span class=n>default</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>default</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>opts</span><span class=p>:</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: default &#39;</span><span class=si>{</span><span class=n>default</span><span class=si>}</span><span class=s2>&#39; not in options </span><span class=si>{</span><span class=n>opts</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>                <span class=n>f</span> <span class=o>=</span> <span class=n>Literal</span><span class=p>[</span><span class=n>opts</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>opts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>t</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>                <span class=n>t</span> <span class=o>=</span> <span class=n>types_set</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span> <span class=k>if</span> <span class=n>types_set</span> <span class=k>else</span> <span class=nb>type</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>                <span class=n>t</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>        <span class=c1># 5b. Handle Enum types</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=nb>type</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>Enum</span><span class=p>):</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>            <span class=n>opts</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>value</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>t</span><span class=p>)</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>opts</span><span class=p>:</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: Enum must have at least one value&quot;</span><span class=p>)</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>            <span class=n>types_set</span> <span class=o>=</span> <span class=p>{</span><span class=nb>type</span><span class=p>(</span><span class=n>v</span><span class=p>)</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>opts</span><span class=p>}</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>types_set</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>                <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: Enum values must be same type&quot;</span><span class=p>)</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>            <span class=k>if</span> <span class=n>default</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>                <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>default</span><span class=p>,</span> <span class=n>t</span><span class=p>):</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: default must be </span><span class=si>{</span><span class=n>t</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2> instance&quot;</span><span class=p>)</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>                <span class=n>default</span> <span class=o>=</span> <span class=n>default</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>            <span class=n>enum_type</span> <span class=o>=</span> <span class=n>t</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>            <span class=n>f</span> <span class=o>=</span> <span class=n>Literal</span><span class=p>[</span><span class=n>opts</span><span class=p>]</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>            <span class=n>t</span> <span class=o>=</span> <span class=n>types_set</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=c1># 6. Validate base type</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=k>if</span> <span class=n>t</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>VALID</span><span class=p>:</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: </span><span class=si>{</span><span class=n>t</span><span class=si>}</span><span class=s2> not supported&quot;</span><span class=p>)</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>        <span class=c1># 7. Validate default value</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>        <span class=k>if</span> <span class=n>default</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>            <span class=k>if</span> <span class=n>is_list</span><span class=p>:</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>                <span class=c1># Must be a list</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>                <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>default</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>                    <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: default must be a list&quot;</span><span class=p>)</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>                <span class=c1># Validate list-level constraints BEFORE converting empty list to None</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>                <span class=k>if</span> <span class=n>list_f</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>list_f</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>                    <span class=n>TypeAdapter</span><span class=p>(</span><span class=n>Annotated</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=n>t</span><span class=p>],</span> <span class=n>list_f</span><span class=p>])</span><span class=o>.</span><span class=n>validate_python</span><span class=p>(</span><span class=n>default</span><span class=p>)</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>                <span class=c1># Validate each item</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>                <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>default</span><span class=p>:</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>                    <span class=c1># Check type</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>                    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>t</span><span class=p>):</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>                        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: list item type mismatch in default&quot;</span><span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>                    <span class=c1># Validate against Field constraints (for items)</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>                    <span class=k>if</span> <span class=n>f</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>                        <span class=n>TypeAdapter</span><span class=p>(</span><span class=n>Annotated</span><span class=p>[</span><span class=n>t</span><span class=p>,</span> <span class=n>f</span><span class=p>])</span><span class=o>.</span><span class=n>validate_python</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>                <span class=c1># Convert empty list to None AFTER validation</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>default</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>                    <span class=n>default</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>                <span class=c1># Non-list validation (existing logic)</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>                <span class=k>if</span> <span class=ow>not</span> <span class=n>is_optional</span> <span class=ow>and</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>f</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=n>Literal</span><span class=p>:</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>                    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>default</span><span class=p>,</span> <span class=n>t</span><span class=p>):</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>                        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: default value type mismatch&quot;</span><span class=p>)</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>                <span class=c1># Validate default value against field constraints</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>                <span class=k>if</span> <span class=n>f</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>                    <span class=n>TypeAdapter</span><span class=p>(</span><span class=n>Annotated</span><span class=p>[</span><span class=n>t</span><span class=p>,</span> <span class=n>f</span><span class=p>])</span><span class=o>.</span><span class=n>validate_python</span><span class=p>(</span><span class=n>default</span><span class=p>)</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>        <span class=c1># 8. Determine optional_enabled state</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>        <span class=c1># Priority: explicit marker &gt; default value presence &gt; False</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=k>if</span> <span class=n>optional_default_enabled</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>            <span class=c1># Explicit marker takes priority</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>            <span class=n>final_optional_enabled</span> <span class=o>=</span> <span class=n>optional_default_enabled</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>        <span class=k>elif</span> <span class=n>default</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a>            <span class=c1># Has default value, start enabled</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>            <span class=n>final_optional_enabled</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>            <span class=c1># No default, start disabled</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>            <span class=n>final_optional_enabled</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>        <span class=n>result</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>ParamInfo</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>default</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>dynamic_func</span><span class=p>,</span> <span class=n>is_optional</span><span class=p>,</span> <span class=n>final_optional_enabled</span><span class=p>,</span> <span class=n>is_list</span><span class=p>,</span> <span class=n>list_f</span><span class=p>,</span> <span class=n>enum_type</span><span class=p>)</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>    <span class=k>return</span> <span class=n>result</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=func_to_web.build_form_fields class="doc doc-heading"> <code>func_to_web.build_form_fields</code> </h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=func_to_web.build_form_fields.build_form_fields class="doc doc-heading"> <code class="highlight language-python"><span class=n>build_form_fields</span><span class=p>(</span><span class=n>params_info</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Build form field specifications from parameter metadata.</p> <p>Re-executes dynamic functions to get fresh options.</p> <p>This function takes the analyzed parameter information from analyze() and converts it into a list of field specifications that can be used by the template engine to generate HTML form inputs.</p> <details class=process open> <summary>Process</summary> <ol> <li>Iterate through each parameter's ParamInfo</li> <li>Determine the appropriate HTML input type (text, number, select, etc.)</li> <li>Extract constraints and convert them to HTML attributes</li> <li>Handle special cases (optional fields, dynamic literals, files, etc.)</li> <li>Serialize defaults to JSON-safe format</li> <li>Return list of field dictionaries ready for template rendering</li> </ol> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>params_info</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Mapping of parameter names to ParamInfo objects. Keys are parameter names (str), values are ParamInfo objects with type, default, field_info, etc.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <p>List of field dictionaries for template rendering. Each dictionary contains:</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>name (str): Parameter name</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>type (str): HTML input type ('text', 'number', 'select', etc.)</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>default (Any): Default value for the field (JSON-serialized)</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>required (bool): Whether field is required (lists are ALWAYS required)</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>is_optional (bool): Whether field has optional toggle</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>optional_enabled (bool): Whether optional field starts enabled</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>is_list (bool): Whether this is a list field</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>list_min_length (int): For list fields, minimum number of items</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>list_max_length (int): For list fields, maximum number of items</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>options (tuple): For select fields, the dropdown options</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>min/max (int/float): For number fields, numeric constraints</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>minlength/maxlength (int): For text fields, length constraints</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>pattern (str): Regex pattern for validation</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>accept (str): For file fields, accepted file extensions</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <ul> <li>step (str): For number fields, '1' for int, 'any' for float</li> </ul> </div> </td> </tr> </tbody> </table> <details class=field-type-detection open> <summary>Field Type Detection</summary> <ul> <li>Literal types â 'select' (dropdown)</li> <li>bool â 'checkbox'</li> <li>date â 'date' (date picker)</li> <li>time â 'time' (time picker)</li> <li>int/float â 'number' (with constraints)</li> <li>str with file pattern â 'file' (file upload)</li> <li>str with color pattern â 'color' (color picker)</li> <li>str with email pattern â 'email' (email input)</li> <li>str (default) â 'text' (text input)</li> </ul> </details> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\build_form_fields.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=k>def</span><span class=w> </span><span class=nf>build_form_fields</span><span class=p>(</span><span class=n>params_info</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build form field specifications from parameter metadata.</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=sd>    Re-executes dynamic functions to get fresh options.</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    This function takes the analyzed parameter information from analyze() and</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=sd>    converts it into a list of field specifications that can be used by the</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    template engine to generate HTML form inputs.</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>    Process:</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>        1. Iterate through each parameter&#39;s ParamInfo</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=sd>        2. Determine the appropriate HTML input type (text, number, select, etc.)</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>        3. Extract constraints and convert them to HTML attributes</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>        4. Handle special cases (optional fields, dynamic literals, files, etc.)</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>        5. Serialize defaults to JSON-safe format</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>        6. Return list of field dictionaries ready for template rendering</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=sd>    Args:</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=sd>        params_info: Mapping of parameter names to ParamInfo objects.</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><span class=sd>            Keys are parameter names (str), values are ParamInfo objects with </span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><span class=sd>            type, default, field_info, etc.</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><span class=sd>    Returns:</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><span class=sd>        List of field dictionaries for template rendering. Each dictionary contains:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><span class=sd>        - name (str): Parameter name</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><span class=sd>        - type (str): HTML input type (&#39;text&#39;, &#39;number&#39;, &#39;select&#39;, etc.)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><span class=sd>        - default (Any): Default value for the field (JSON-serialized)</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><span class=sd>        - required (bool): Whether field is required (lists are ALWAYS required)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><span class=sd>        - is_optional (bool): Whether field has optional toggle</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><span class=sd>        - optional_enabled (bool): Whether optional field starts enabled</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><span class=sd>        - is_list (bool): Whether this is a list field</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><span class=sd>        - list_min_length (int): For list fields, minimum number of items</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><span class=sd>        - list_max_length (int): For list fields, maximum number of items</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><span class=sd>        - options (tuple): For select fields, the dropdown options</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><span class=sd>        - min/max (int/float): For number fields, numeric constraints</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><span class=sd>        - minlength/maxlength (int): For text fields, length constraints</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><span class=sd>        - pattern (str): Regex pattern for validation</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><span class=sd>        - accept (str): For file fields, accepted file extensions</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><span class=sd>        - step (str): For number fields, &#39;1&#39; for int, &#39;any&#39; for float</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><span class=sd>    Field Type Detection:</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><span class=sd>        - Literal types â &#39;select&#39; (dropdown)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><span class=sd>        - bool â &#39;checkbox&#39;</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><span class=sd>        - date â &#39;date&#39; (date picker)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><span class=sd>        - time â &#39;time&#39; (time picker)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><span class=sd>        - int/float â &#39;number&#39; (with constraints)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><span class=sd>        - str with file pattern â &#39;file&#39; (file upload)</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=sd>        - str with color pattern â &#39;color&#39; (color picker)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=sd>        - str with email pattern â &#39;email&#39; (email input)</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>        - str (default) â &#39;text&#39; (text input)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=n>fields</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>info</span> <span class=ow>in</span> <span class=n>params_info</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=c1># Serialize default value to JSON-safe format</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=n>serialized_default</span> <span class=o>=</span> <span class=n>serialize_for_json</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>default</span><span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>        <span class=n>field</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>name</span><span class=p>,</span> 
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>            <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=n>serialized_default</span><span class=p>,</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>            <span class=c1># REGLA SIMPLE: Las listas SIEMPRE son required=True</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=c1># Si el campo estÃ¡ habilitado (no opcional O toggle ON), debe tener valor</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=c1># Las listas nunca pueden estar vacÃ­as, si se quiere vacÃ­o usar None</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=s1>&#39;required&#39;</span><span class=p>:</span> <span class=kc>True</span> <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>is_list</span> <span class=k>else</span> <span class=ow>not</span> <span class=n>info</span><span class=o>.</span><span class=n>is_optional</span><span class=p>,</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=s1>&#39;is_optional&#39;</span><span class=p>:</span> <span class=n>info</span><span class=o>.</span><span class=n>is_optional</span><span class=p>,</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=s1>&#39;optional_enabled&#39;</span><span class=p>:</span> <span class=n>info</span><span class=o>.</span><span class=n>optional_enabled</span><span class=p>,</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>            <span class=s1>&#39;is_list&#39;</span><span class=p>:</span> <span class=n>info</span><span class=o>.</span><span class=n>is_list</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>        <span class=p>}</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>        <span class=c1># Si es una lista, extraer los constraints de lista (min_length, max_length)</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>is_list</span> <span class=ow>and</span> <span class=n>info</span><span class=o>.</span><span class=n>list_field_info</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>list_field_info</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>            <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>info</span><span class=o>.</span><span class=n>list_field_info</span><span class=o>.</span><span class=n>metadata</span><span class=p>:</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>                <span class=n>cn</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>                <span class=k>if</span> <span class=n>cn</span> <span class=o>==</span> <span class=s1>&#39;MinLen&#39;</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>                    <span class=n>field</span><span class=p>[</span><span class=s1>&#39;list_min_length&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>min_length</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>                <span class=k>if</span> <span class=n>cn</span> <span class=o>==</span> <span class=s1>&#39;MaxLen&#39;</span><span class=p>:</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>                    <span class=n>field</span><span class=p>[</span><span class=s1>&#39;list_max_length&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>max_length</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>        <span class=c1># Dropdown select</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Literal</span><span class=p>:</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;select&#39;</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=c1># Re-execute dynamic function if present</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>            <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>dynamic_func</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>                <span class=n>result_value</span> <span class=o>=</span> <span class=n>info</span><span class=o>.</span><span class=n>dynamic_func</span><span class=p>()</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>                <span class=c1># Convert result to tuple properly</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>                <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result_value</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>                    <span class=n>fresh_options</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>result_value</span><span class=p>)</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>                    <span class=n>fresh_options</span> <span class=o>=</span> <span class=p>(</span><span class=n>result_value</span><span class=p>,)</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>                <span class=n>field</span><span class=p>[</span><span class=s1>&#39;options&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>fresh_options</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>                <span class=n>info</span><span class=o>.</span><span class=n>field_info</span> <span class=o>=</span> <span class=n>Literal</span><span class=p>[</span><span class=n>fresh_options</span><span class=p>]</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>                <span class=n>field</span><span class=p>[</span><span class=s1>&#39;options&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>)</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>        <span class=c1># Checkbox</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>        <span class=k>elif</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;checkbox&#39;</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;required&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=c1># Date picker</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=k>elif</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=n>date</span><span class=p>:</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;date&#39;</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>            <span class=c1># Already serialized above, no need to do it again</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>        <span class=c1># Time picker</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>        <span class=k>elif</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=n>time</span><span class=p>:</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;time&#39;</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>            <span class=c1># Already serialized above, no need to do it again</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>        <span class=c1># Number input</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>        <span class=k>elif</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>in</span> <span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>):</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;number&#39;</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;step&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;1&#39;</span> <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>int</span> <span class=k>else</span> <span class=s1>&#39;any&#39;</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>            <span class=c1># Extract numeric constraints from Pydantic Field</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>            <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>field_info</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>                <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=o>.</span><span class=n>metadata</span><span class=p>:</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>                    <span class=n>cn</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>                    <span class=k>if</span> <span class=n>cn</span> <span class=o>==</span> <span class=s1>&#39;Ge&#39;</span><span class=p>:</span> <span class=n>field</span><span class=p>[</span><span class=s1>&#39;min&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>ge</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>                    <span class=k>elif</span> <span class=n>cn</span> <span class=o>==</span> <span class=s1>&#39;Le&#39;</span><span class=p>:</span> <span class=n>field</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>le</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>                    <span class=k>elif</span> <span class=n>cn</span> <span class=o>==</span> <span class=s1>&#39;Gt&#39;</span><span class=p>:</span> <span class=n>field</span><span class=p>[</span><span class=s1>&#39;min&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>gt</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>int</span> <span class=k>else</span> <span class=mf>0.01</span><span class=p>)</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                    <span class=k>elif</span> <span class=n>cn</span> <span class=o>==</span> <span class=s1>&#39;Lt&#39;</span><span class=p>:</span> <span class=n>field</span><span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>lt</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>int</span> <span class=k>else</span> <span class=mf>0.01</span><span class=p>)</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>        <span class=c1># Text/email/color/file input</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;text&#39;</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>            <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>field_info</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>                <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=o>.</span><span class=n>metadata</span><span class=p>:</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>                    <span class=n>cn</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                    <span class=c1># Check for pattern constraints</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>                    <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=s1>&#39;pattern&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>c</span><span class=o>.</span><span class=n>pattern</span><span class=p>:</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>                        <span class=n>pattern</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>pattern</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>                        <span class=c1># File input detection</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>                        <span class=k>if</span> <span class=n>pattern</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^.+\.(&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>pattern</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;)$&#39;</span><span class=p>):</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;file&#39;</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>                            <span class=n>exts</span> <span class=o>=</span> <span class=n>pattern</span><span class=p>[</span><span class=mi>6</span><span class=p>:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;|&#39;</span><span class=p>)</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>                            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;accept&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;.&#39;</span> <span class=o>+</span> <span class=s1>&#39;,.&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>exts</span><span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>                        <span class=c1># Special input types (color, email)</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>                        <span class=k>elif</span> <span class=n>pattern</span> <span class=ow>in</span> <span class=n>PATTERN_TO_HTML_TYPE</span><span class=p>:</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>                            <span class=n>field</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>PATTERN_TO_HTML_TYPE</span><span class=p>[</span><span class=n>pattern</span><span class=p>]</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>                        <span class=n>field</span><span class=p>[</span><span class=s1>&#39;pattern&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pattern</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>                    <span class=c1># String length constraints</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>                    <span class=k>if</span> <span class=n>cn</span> <span class=o>==</span> <span class=s1>&#39;MinLen&#39;</span><span class=p>:</span> 
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>                        <span class=n>field</span><span class=p>[</span><span class=s1>&#39;minlength&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>min_length</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>                    <span class=k>if</span> <span class=n>cn</span> <span class=o>==</span> <span class=s1>&#39;MaxLen&#39;</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>                        <span class=n>field</span><span class=p>[</span><span class=s1>&#39;maxlength&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>max_length</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>        <span class=n>fields</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>field</span><span class=p>)</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>    <span class=k>return</span> <span class=n>fields</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.build_form_fields.serialize_for_json class="doc doc-heading"> <code class="highlight language-python"><span class=n>serialize_for_json</span><span class=p>(</span><span class=n>value</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Serialize a value to be JSON-safe for template rendering.</p> <p>Converts date/time objects to ISO format strings.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>value</code> </td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>The value to serialize (can be any type).</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>JSON-safe serialized value (str for dates/times, or original type).</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\build_form_fields.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-9> 9</a></span>
<span class=normal><a href=#__codelineno-0-10>10</a></span>
<span class=normal><a href=#__codelineno-0-11>11</a></span>
<span class=normal><a href=#__codelineno-0-12>12</a></span>
<span class=normal><a href=#__codelineno-0-13>13</a></span>
<span class=normal><a href=#__codelineno-0-14>14</a></span>
<span class=normal><a href=#__codelineno-0-15>15</a></span>
<span class=normal><a href=#__codelineno-0-16>16</a></span>
<span class=normal><a href=#__codelineno-0-17>17</a></span>
<span class=normal><a href=#__codelineno-0-18>18</a></span>
<span class=normal><a href=#__codelineno-0-19>19</a></span>
<span class=normal><a href=#__codelineno-0-20>20</a></span>
<span class=normal><a href=#__codelineno-0-21>21</a></span>
<span class=normal><a href=#__codelineno-0-22>22</a></span>
<span class=normal><a href=#__codelineno-0-23>23</a></span>
<span class=normal><a href=#__codelineno-0-24>24</a></span>
<span class=normal><a href=#__codelineno-0-25>25</a></span>
<span class=normal><a href=#__codelineno-0-26>26</a></span>
<span class=normal><a href=#__codelineno-0-27>27</a></span>
<span class=normal><a href=#__codelineno-0-28>28</a></span>
<span class=normal><a href=#__codelineno-0-29>29</a></span>
<span class=normal><a href=#__codelineno-0-30>30</a></span>
<span class=normal><a href=#__codelineno-0-31>31</a></span>
<span class=normal><a href=#__codelineno-0-32>32</a></span>
<span class=normal><a href=#__codelineno-0-33>33</a></span>
<span class=normal><a href=#__codelineno-0-34>34</a></span>
<span class=normal><a href=#__codelineno-0-35>35</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><span class=k>def</span><span class=w> </span><span class=nf>serialize_for_json</span><span class=p>(</span><span class=n>value</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Serialize a value to be JSON-safe for template rendering.</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=sd>    Converts date/time objects to ISO format strings.</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    Args:</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=sd>        value: The value to serialize (can be any type).</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    Returns:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>        JSON-safe serialized value (str for dates/times, or original type).</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=k>if</span> <span class=n>value</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>date</span><span class=p>):</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>        <span class=k>return</span> <span class=n>value</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>time</span><span class=p>):</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>        <span class=k>return</span> <span class=n>value</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>        <span class=k>return</span> <span class=p>[</span><span class=n>serialize_for_json</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>value</span><span class=p>]</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>        <span class=k>return</span> <span class=p>{</span><span class=n>k</span><span class=p>:</span> <span class=n>serialize_for_json</span><span class=p>(</span><span class=n>v</span><span class=p>)</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>value</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=k>return</span> <span class=n>value</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=func_to_web.process_result class="doc doc-heading"> <code>func_to_web.process_result</code> </h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=func_to_web.process_result.process_result class="doc doc-heading"> <code class="highlight language-python"><span class=n>process_result</span><span class=p>(</span><span class=n>result</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Convert function result to appropriate display format.</p> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\process_result.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-7>  7</a></span>
<span class=normal><a href=#__codelineno-0-8>  8</a></span>
<span class=normal><a href=#__codelineno-0-9>  9</a></span>
<span class=normal><a href=#__codelineno-0-10> 10</a></span>
<span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><span class=k>def</span><span class=w> </span><span class=nf>process_result</span><span class=p>(</span><span class=n>result</span><span class=p>):</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><span class=sd>    Convert function result to appropriate display format.</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=c1># ===== PANDAS DATAFRAME =====</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a>        <span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a>            <span class=n>headers</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a>            <span class=n>rows</span> <span class=o>=</span> <span class=p>[[</span><span class=nb>str</span><span class=p>(</span><span class=n>cell</span><span class=p>)</span> <span class=k>for</span> <span class=n>cell</span> <span class=ow>in</span> <span class=n>row</span><span class=p>]</span> <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>tolist</span><span class=p>()]</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;table&#39;</span><span class=p>,</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a>                <span class=s1>&#39;headers&#39;</span><span class=p>:</span> <span class=n>headers</span><span class=p>,</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a>                <span class=s1>&#39;rows&#39;</span><span class=p>:</span> <span class=n>rows</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a>            <span class=p>}</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a>        <span class=k>pass</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=c1># ===== NUMPY 2D ARRAY =====</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a>        <span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=ow>and</span> <span class=n>result</span><span class=o>.</span><span class=n>ndim</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a>            <span class=n>headers</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;Column </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])]</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a>            <span class=n>rows</span> <span class=o>=</span> <span class=p>[[</span><span class=nb>str</span><span class=p>(</span><span class=n>cell</span><span class=p>)</span> <span class=k>for</span> <span class=n>cell</span> <span class=ow>in</span> <span class=n>row</span><span class=p>]</span> <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>tolist</span><span class=p>()]</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;table&#39;</span><span class=p>,</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a>                <span class=s1>&#39;headers&#39;</span><span class=p>:</span> <span class=n>headers</span><span class=p>,</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>                <span class=s1>&#39;rows&#39;</span><span class=p>:</span> <span class=n>rows</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a>            <span class=p>}</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a>        <span class=k>pass</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a>    <span class=c1># ===== POLARS DATAFRAME =====</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a>        <span class=kn>import</span><span class=w> </span><span class=nn>polars</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pl</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=n>pl</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>):</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a>            <span class=n>headers</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>columns</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>            <span class=n>rows</span> <span class=o>=</span> <span class=p>[[</span><span class=nb>str</span><span class=p>(</span><span class=n>cell</span><span class=p>)</span> <span class=k>for</span> <span class=n>cell</span> <span class=ow>in</span> <span class=n>row</span><span class=p>]</span> <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>rows</span><span class=p>()]</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;table&#39;</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>                <span class=s1>&#39;headers&#39;</span><span class=p>:</span> <span class=n>headers</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>                <span class=s1>&#39;rows&#39;</span><span class=p>:</span> <span class=n>rows</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>            <span class=p>}</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>    <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=k>pass</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>    <span class=c1># ===== TABLE DETECTION (FIRST) =====</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>    <span class=n>table_result</span> <span class=o>=</span> <span class=n>detect_and_convert_table</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>    <span class=k>if</span> <span class=n>table_result</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=k>return</span> <span class=n>table_result</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>    <span class=c1># ===== TUPLE/LIST HANDLING (with smart nesting validation) =====</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=p>(</span><span class=nb>tuple</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>        <span class=c1># Empty tuple/list</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>            <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;text&#39;</span><span class=p>,</span> <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>result</span><span class=p>)}</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>        <span class=c1># Check for nested tuples/lists that are NOT valid tables</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>        <span class=k>for</span> <span class=n>nested_item</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>nested_item</span><span class=p>,</span> <span class=p>(</span><span class=nb>tuple</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>                <span class=c1># If it&#39;s a valid table, allow it</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>                <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>is_homogeneous_list_of_dicts</span><span class=p>(</span><span class=n>nested_item</span><span class=p>)</span> <span class=ow>or</span> <span class=n>is_homogeneous_list_of_tuples</span><span class=p>(</span><span class=n>nested_item</span><span class=p>)):</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Nested tuples/lists are not supported. Please flatten your return structure.&quot;</span><span class=p>)</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>        <span class=c1># Special case: list of FileResponse</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>        <span class=k>if</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>UserFileResponse</span><span class=p>)</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>result</span><span class=p>):</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>            <span class=n>files</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>            <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>                <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>NamedTemporaryFile</span><span class=p>(</span><span class=n>delete</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>f</span><span class=o>.</span><span class=n>filename</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>tmp</span><span class=p>:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>                    <span class=n>tmp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>                    <span class=n>files</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>                        <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=n>tmp</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>                        <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>f</span><span class=o>.</span><span class=n>filename</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>                    <span class=p>})</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;downloads&#39;</span><span class=p>,</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>                <span class=s1>&#39;files&#39;</span><span class=p>:</span> <span class=n>files</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>            <span class=p>}</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>        <span class=c1># General case: process each item recursively</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>        <span class=n>outputs</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>        <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>result</span><span class=p>:</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>            <span class=n>outputs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>process_result</span><span class=p>(</span><span class=n>item</span><span class=p>))</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>        <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>            <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;multiple&#39;</span><span class=p>,</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>            <span class=s1>&#39;outputs&#39;</span><span class=p>:</span> <span class=n>outputs</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=p>}</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>    <span class=c1># ===== PIL IMAGE =====</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>        <span class=kn>from</span><span class=w> </span><span class=nn>PIL</span><span class=w> </span><span class=kn>import</span> <span class=n>Image</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=n>Image</span><span class=o>.</span><span class=n>Image</span><span class=p>):</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>            <span class=n>buffer</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>()</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>            <span class=n>result</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;PNG&#39;</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>            <span class=n>buffer</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>            <span class=n>img_base64</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>buffer</span><span class=o>.</span><span class=n>read</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;image&#39;</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>                <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s1>&#39;data:image/png;base64,</span><span class=si>{</span><span class=n>img_base64</span><span class=si>}</span><span class=s1>&#39;</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=p>}</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>    <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>        <span class=k>pass</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>    <span class=c1># ===== MATPLOTLIB FIGURE =====</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=kn>from</span><span class=w> </span><span class=nn>matplotlib.figure</span><span class=w> </span><span class=kn>import</span> <span class=n>Figure</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=n>Figure</span><span class=p>):</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>            <span class=n>buffer</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>()</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>            <span class=n>result</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;png&#39;</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>            <span class=n>buffer</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=n>img_base64</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>buffer</span><span class=o>.</span><span class=n>read</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>            <span class=n>plt</span><span class=o>.</span><span class=n>close</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;image&#39;</span><span class=p>,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a>                <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s1>&#39;data:image/png;base64,</span><span class=si>{</span><span class=n>img_base64</span><span class=si>}</span><span class=s1>&#39;</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a>            <span class=p>}</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a>    <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>        <span class=k>pass</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>    <span class=c1># ===== SINGLE FILE =====</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=n>UserFileResponse</span><span class=p>):</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>        <span class=k>with</span> <span class=n>tempfile</span><span class=o>.</span><span class=n>NamedTemporaryFile</span><span class=p>(</span><span class=n>delete</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>filename</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>tmp</span><span class=p>:</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>            <span class=n>tmp</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>            <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;download&#39;</span><span class=p>,</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>                <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=n>tmp</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>                <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>result</span><span class=o>.</span><span class=n>filename</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>            <span class=p>}</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>    <span class=c1># ===== DEFAULT: TEXT =====</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>        <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;text&#39;</span><span class=p>,</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>        <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>    <span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-module"> <h2 id=func_to_web.validate_params class="doc doc-heading"> <code>func_to_web.validate_params</code> </h2> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=func_to_web.validate_params.validate_list_param class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_list_param</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>info</span><span class=p>,</span> <span class=n>param_name</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Validate and convert a JSON string to a typed list.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>value</code> </td> <td> <code><span title=str>str</span> | None</code> </td> <td> <div class=doc-md-description> <p>JSON string like "[1, 2, 3]" or "[]".</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>info</code> </td> <td> <code><a class="autorefs autorefs-internal" title="ParamInfo


  
      dataclass
   (func_to_web.analyze_function.ParamInfo)" href=#func_to_web.analyze_function.ParamInfo>ParamInfo</a></code> </td> <td> <div class=doc-md-description> <p>ParamInfo with type and constraints for list items.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>param_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of the parameter (for error messages).</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>Validated list with proper types.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If value is not a valid list.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If items don't pass validation or list size constraints are violated.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=json.JSONDecodeError>JSONDecodeError</span></code> </td> <td> <div class=doc-md-description> <p>If JSON is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\validate_params.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=k>def</span><span class=w> </span><span class=nf>validate_list_param</span><span class=p>(</span><span class=n>value</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span> <span class=n>info</span><span class=p>:</span> <span class=n>ParamInfo</span><span class=p>,</span> <span class=n>param_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>:</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Validate and convert a JSON string to a typed list.</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>    Args:</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><span class=sd>        value: JSON string like &quot;[1, 2, 3]&quot; or &quot;[]&quot;.</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>        info: ParamInfo with type and constraints for list items.</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        param_name: Name of the parameter (for error messages).</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=sd>    Returns:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>        Validated list with proper types.</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>    Raises:</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>        TypeError: If value is not a valid list.</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>        ValueError: If items don&#39;t pass validation or list size constraints are violated.</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>        json.JSONDecodeError: If JSON is invalid.</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>    <span class=c1># Parse JSON</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>value</span> <span class=ow>or</span> <span class=n>value</span> <span class=o>==</span> <span class=s2>&quot;&quot;</span><span class=p>:</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a>        <span class=n>list_value</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>            <span class=n>list_value</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>        <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>param_name</span><span class=si>}</span><span class=s2>&#39;: Invalid list format: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>list_value</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>param_name</span><span class=si>}</span><span class=s2>&#39;: Expected list, got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>list_value</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>    <span class=c1># Validate list-level constraints (min_length, max_length)</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a>    <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>list_field_info</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>list_field_info</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a>        <span class=n>min_length</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>        <span class=n>max_length</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a>        <span class=k>for</span> <span class=n>constraint</span> <span class=ow>in</span> <span class=n>info</span><span class=o>.</span><span class=n>list_field_info</span><span class=o>.</span><span class=n>metadata</span><span class=p>:</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a>            <span class=n>constraint_name</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>constraint</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a>            <span class=k>if</span> <span class=n>constraint_name</span> <span class=o>==</span> <span class=s1>&#39;MinLen&#39;</span><span class=p>:</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>                <span class=n>min_length</span> <span class=o>=</span> <span class=n>constraint</span><span class=o>.</span><span class=n>min_length</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a>            <span class=k>elif</span> <span class=n>constraint_name</span> <span class=o>==</span> <span class=s1>&#39;MaxLen&#39;</span><span class=p>:</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>                <span class=n>max_length</span> <span class=o>=</span> <span class=n>constraint</span><span class=o>.</span><span class=n>max_length</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>            <span class=k>elif</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>constraint</span><span class=p>,</span> <span class=s1>&#39;min_length&#39;</span><span class=p>):</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a>                <span class=n>min_length</span> <span class=o>=</span> <span class=n>constraint</span><span class=o>.</span><span class=n>min_length</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>            <span class=k>elif</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>constraint</span><span class=p>,</span> <span class=s1>&#39;max_length&#39;</span><span class=p>):</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>                <span class=n>max_length</span> <span class=o>=</span> <span class=n>constraint</span><span class=o>.</span><span class=n>max_length</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>        <span class=c1># Validate min_length</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>        <span class=k>if</span> <span class=n>min_length</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>list_value</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>min_length</span><span class=p>:</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>                <span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>param_name</span><span class=si>}</span><span class=s2>&#39;: List must have at least </span><span class=si>{</span><span class=n>min_length</span><span class=si>}</span><span class=s2> item</span><span class=si>{</span><span class=s1>&#39;s&#39;</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>min_length</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>                <span class=sa>f</span><span class=s2>&quot;got </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>list_value</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>            <span class=p>)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=c1># Validate max_length</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=k>if</span> <span class=n>max_length</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>list_value</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>max_length</span><span class=p>:</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>                <span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>param_name</span><span class=si>}</span><span class=s2>&#39;: List must have at most </span><span class=si>{</span><span class=n>max_length</span><span class=si>}</span><span class=s2> item</span><span class=si>{</span><span class=s1>&#39;s&#39;</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>max_length</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=si>}</span><span class=s2>, &quot;</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>                <span class=sa>f</span><span class=s2>&quot;got </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>list_value</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>            <span class=p>)</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>    <span class=c1># Validate each item</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>    <span class=n>validated_list</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>item</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>list_value</span><span class=p>):</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=n>validated_item</span> <span class=o>=</span> <span class=n>validate_single_item</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>info</span><span class=p>)</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=n>validated_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>validated_item</span><span class=p>)</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>        <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>param_name</span><span class=si>}</span><span class=s2>&#39;: List item at index </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>    <span class=k>return</span> <span class=n>validated_list</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.validate_params.validate_params class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_params</span><span class=p>(</span><span class=n>form_data</span><span class=p>,</span> <span class=n>params_info</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Validate and convert form data to function parameters.</p> <p>This function takes raw form data (where everything is a string) and converts it to the proper Python types based on the parameter metadata from analyze(). It handles type conversion, optional field toggles, and validates against constraints defined in Pydantic Field or Literal types.</p> <details class=process open> <summary>Process</summary> <ol> <li>Check if optional fields are enabled via toggle</li> <li>Convert strings to proper types (int, float, date, time, bool)</li> <li>For lists: parse JSON and validate each item</li> <li>Validate Literal values against allowed options</li> <li>Validate against Pydantic Field constraints (ge, le, min_length, etc.)</li> <li>Handle special cases (hex color expansion, empty values)</li> </ol> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>form_data</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Raw form data from HTTP request. - Keys are parameter names (str) - Values are form values (str, or None for checkboxes) - For lists: JSON string like "[1, 2, 3]" - Optional toggles have keys like "{param}_optional_toggle"</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>params_info</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <a class="autorefs autorefs-internal" title="ParamInfo


  
      dataclass
   (func_to_web.analyze_function.ParamInfo)" href=#func_to_web.analyze_function.ParamInfo>ParamInfo</a>]</code> </td> <td> <div class=doc-md-description> <p>Parameter metadata from analyze(). - Keys are parameter names (str) - Values are ParamInfo objects with type and validation info</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Validated parameters ready for function call.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Keys are parameter names (str), values are properly typed Python objects.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If a value doesn't match Literal options or Field constraints.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=TypeError>TypeError</span></code> </td> <td> <div class=doc-md-description> <p>If type conversion fails.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><span title=json.JSONDecodeError>JSONDecodeError</span></code> </td> <td> <div class=doc-md-description> <p>If list JSON is invalid.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\validate_params.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-9>  9</a></span>
<span class=normal><a href=#__codelineno-0-10> 10</a></span>
<span class=normal><a href=#__codelineno-0-11> 11</a></span>
<span class=normal><a href=#__codelineno-0-12> 12</a></span>
<span class=normal><a href=#__codelineno-0-13> 13</a></span>
<span class=normal><a href=#__codelineno-0-14> 14</a></span>
<span class=normal><a href=#__codelineno-0-15> 15</a></span>
<span class=normal><a href=#__codelineno-0-16> 16</a></span>
<span class=normal><a href=#__codelineno-0-17> 17</a></span>
<span class=normal><a href=#__codelineno-0-18> 18</a></span>
<span class=normal><a href=#__codelineno-0-19> 19</a></span>
<span class=normal><a href=#__codelineno-0-20> 20</a></span>
<span class=normal><a href=#__codelineno-0-21> 21</a></span>
<span class=normal><a href=#__codelineno-0-22> 22</a></span>
<span class=normal><a href=#__codelineno-0-23> 23</a></span>
<span class=normal><a href=#__codelineno-0-24> 24</a></span>
<span class=normal><a href=#__codelineno-0-25> 25</a></span>
<span class=normal><a href=#__codelineno-0-26> 26</a></span>
<span class=normal><a href=#__codelineno-0-27> 27</a></span>
<span class=normal><a href=#__codelineno-0-28> 28</a></span>
<span class=normal><a href=#__codelineno-0-29> 29</a></span>
<span class=normal><a href=#__codelineno-0-30> 30</a></span>
<span class=normal><a href=#__codelineno-0-31> 31</a></span>
<span class=normal><a href=#__codelineno-0-32> 32</a></span>
<span class=normal><a href=#__codelineno-0-33> 33</a></span>
<span class=normal><a href=#__codelineno-0-34> 34</a></span>
<span class=normal><a href=#__codelineno-0-35> 35</a></span>
<span class=normal><a href=#__codelineno-0-36> 36</a></span>
<span class=normal><a href=#__codelineno-0-37> 37</a></span>
<span class=normal><a href=#__codelineno-0-38> 38</a></span>
<span class=normal><a href=#__codelineno-0-39> 39</a></span>
<span class=normal><a href=#__codelineno-0-40> 40</a></span>
<span class=normal><a href=#__codelineno-0-41> 41</a></span>
<span class=normal><a href=#__codelineno-0-42> 42</a></span>
<span class=normal><a href=#__codelineno-0-43> 43</a></span>
<span class=normal><a href=#__codelineno-0-44> 44</a></span>
<span class=normal><a href=#__codelineno-0-45> 45</a></span>
<span class=normal><a href=#__codelineno-0-46> 46</a></span>
<span class=normal><a href=#__codelineno-0-47> 47</a></span>
<span class=normal><a href=#__codelineno-0-48> 48</a></span>
<span class=normal><a href=#__codelineno-0-49> 49</a></span>
<span class=normal><a href=#__codelineno-0-50> 50</a></span>
<span class=normal><a href=#__codelineno-0-51> 51</a></span>
<span class=normal><a href=#__codelineno-0-52> 52</a></span>
<span class=normal><a href=#__codelineno-0-53> 53</a></span>
<span class=normal><a href=#__codelineno-0-54> 54</a></span>
<span class=normal><a href=#__codelineno-0-55> 55</a></span>
<span class=normal><a href=#__codelineno-0-56> 56</a></span>
<span class=normal><a href=#__codelineno-0-57> 57</a></span>
<span class=normal><a href=#__codelineno-0-58> 58</a></span>
<span class=normal><a href=#__codelineno-0-59> 59</a></span>
<span class=normal><a href=#__codelineno-0-60> 60</a></span>
<span class=normal><a href=#__codelineno-0-61> 61</a></span>
<span class=normal><a href=#__codelineno-0-62> 62</a></span>
<span class=normal><a href=#__codelineno-0-63> 63</a></span>
<span class=normal><a href=#__codelineno-0-64> 64</a></span>
<span class=normal><a href=#__codelineno-0-65> 65</a></span>
<span class=normal><a href=#__codelineno-0-66> 66</a></span>
<span class=normal><a href=#__codelineno-0-67> 67</a></span>
<span class=normal><a href=#__codelineno-0-68> 68</a></span>
<span class=normal><a href=#__codelineno-0-69> 69</a></span>
<span class=normal><a href=#__codelineno-0-70> 70</a></span>
<span class=normal><a href=#__codelineno-0-71> 71</a></span>
<span class=normal><a href=#__codelineno-0-72> 72</a></span>
<span class=normal><a href=#__codelineno-0-73> 73</a></span>
<span class=normal><a href=#__codelineno-0-74> 74</a></span>
<span class=normal><a href=#__codelineno-0-75> 75</a></span>
<span class=normal><a href=#__codelineno-0-76> 76</a></span>
<span class=normal><a href=#__codelineno-0-77> 77</a></span>
<span class=normal><a href=#__codelineno-0-78> 78</a></span>
<span class=normal><a href=#__codelineno-0-79> 79</a></span>
<span class=normal><a href=#__codelineno-0-80> 80</a></span>
<span class=normal><a href=#__codelineno-0-81> 81</a></span>
<span class=normal><a href=#__codelineno-0-82> 82</a></span>
<span class=normal><a href=#__codelineno-0-83> 83</a></span>
<span class=normal><a href=#__codelineno-0-84> 84</a></span>
<span class=normal><a href=#__codelineno-0-85> 85</a></span>
<span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span>
<span class=normal><a href=#__codelineno-0-101>101</a></span>
<span class=normal><a href=#__codelineno-0-102>102</a></span>
<span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><span class=k>def</span><span class=w> </span><span class=nf>validate_params</span><span class=p>(</span><span class=n>form_data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span> <span class=n>params_info</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>ParamInfo</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Validate and convert form data to function parameters.</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=sd>    This function takes raw form data (where everything is a string) and converts</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=sd>    it to the proper Python types based on the parameter metadata from analyze().</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=sd>    It handles type conversion, optional field toggles, and validates against</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=sd>    constraints defined in Pydantic Field or Literal types.</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=sd>    Process:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=sd>        1. Check if optional fields are enabled via toggle</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=sd>        2. Convert strings to proper types (int, float, date, time, bool)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=sd>        3. For lists: parse JSON and validate each item</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=sd>        4. Validate Literal values against allowed options</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=sd>        5. Validate against Pydantic Field constraints (ge, le, min_length, etc.)</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=sd>        6. Handle special cases (hex color expansion, empty values)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=sd>    Args:</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=sd>        form_data: Raw form data from HTTP request.</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=sd>            - Keys are parameter names (str)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=sd>            - Values are form values (str, or None for checkboxes)</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=sd>            - For lists: JSON string like &quot;[1, 2, 3]&quot;</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=sd>            - Optional toggles have keys like &quot;{param}_optional_toggle&quot;</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=sd>        params_info: Parameter metadata from analyze().</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=sd>            - Keys are parameter names (str)</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=sd>            - Values are ParamInfo objects with type and validation info</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=sd>    Returns:</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=sd>        Validated parameters ready for function call.</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=sd>        Keys are parameter names (str), values are properly typed Python objects.</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=sd>    Raises:</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=sd>        ValueError: If a value doesn&#39;t match Literal options or Field constraints.</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=sd>        TypeError: If type conversion fails.</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=sd>        json.JSONDecodeError: If list JSON is invalid.</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>    <span class=n>validated</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a>    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>info</span> <span class=ow>in</span> <span class=n>params_info</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a>        <span class=n>value</span> <span class=o>=</span> <span class=n>form_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>        <span class=c1># Check if optional field is disabled</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a>        <span class=n>optional_toggle_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>_optional_toggle&quot;</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a>        <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>is_optional</span> <span class=ow>and</span> <span class=n>optional_toggle_name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>form_data</span><span class=p>:</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a>            <span class=c1># Optional field is disabled, send None</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a>            <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a>            <span class=k>continue</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=c1># Handle list fields</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>        <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>is_list</span><span class=p>:</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>            <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>validate_list_param</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>info</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>            <span class=k>continue</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>        <span class=c1># Checkbox handling</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a>        <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a>            <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a>            <span class=k>continue</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a>        <span class=c1># Date conversion</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a>        <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=n>date</span><span class=p>:</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a>            <span class=k>if</span> <span class=n>value</span><span class=p>:</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a>                <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>date</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a>                <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a>            <span class=k>continue</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a>        <span class=c1># Time conversion</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a>        <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=n>time</span><span class=p>:</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a>            <span class=k>if</span> <span class=n>value</span><span class=p>:</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a>                <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a>                <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a>            <span class=k>continue</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a>        <span class=c1># Literal validation</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a>        <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Literal</span><span class=p>:</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a>            <span class=c1># Convert to correct type</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a>            <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a>                <span class=n>value</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a>            <span class=k>elif</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>                <span class=n>value</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>            <span class=c1># Only validate against options if Literal is NOT dynamic</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a>            <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>dynamic_func</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>                <span class=n>opts</span> <span class=o>=</span> <span class=n>get_args</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>)</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>                <span class=k>if</span> <span class=n>value</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>opts</span><span class=p>:</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: value &#39;</span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&#39; not in </span><span class=si>{</span><span class=n>opts</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>            <span class=c1># Convert string â Enum if needed</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>enum_type</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>                <span class=c1># Find the Enum member with this value</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>                <span class=k>for</span> <span class=n>member</span> <span class=ow>in</span> <span class=n>info</span><span class=o>.</span><span class=n>enum_type</span><span class=p>:</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>                    <span class=k>if</span> <span class=n>member</span><span class=o>.</span><span class=n>value</span> <span class=o>==</span> <span class=n>value</span><span class=p>:</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a>                        <span class=n>value</span> <span class=o>=</span> <span class=n>member</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a>                        <span class=k>break</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a>                    <span class=c1># This shouldn&#39;t happen if validation passed</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;: invalid value for </span><span class=si>{</span><span class=n>info</span><span class=o>.</span><span class=n>enum_type</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>            <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a>            <span class=k>continue</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>        <span class=c1># Expand shorthand hex colors (#RGB -&gt; #RRGGBB)</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=k>if</span> <span class=n>value</span> <span class=ow>and</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=ow>and</span> <span class=n>value</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;#&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>            <span class=n>value</span> <span class=o>=</span> <span class=s1>&#39;#&#39;</span> <span class=o>+</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>c</span><span class=o>*</span><span class=mi>2</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>value</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>        <span class=c1># Pydantic validation with constraints</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>        <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>field_info</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>            <span class=n>adapter</span> <span class=o>=</span> <span class=n>TypeAdapter</span><span class=p>(</span><span class=n>Annotated</span><span class=p>[</span><span class=n>info</span><span class=o>.</span><span class=n>type</span><span class=p>,</span> <span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>])</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>            <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>adapter</span><span class=o>.</span><span class=n>validate_python</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>            <span class=n>validated</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>if</span> <span class=n>value</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>    <span class=k>return</span> <span class=n>validated</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=func_to_web.validate_params.validate_single_item class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_single_item</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>info</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Validate a single list item.</p> <p>Reuses the same validation logic as non-list parameters.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>item</code> </td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>The item value from the JSON array.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>info</code> </td> <td> <code><a class="autorefs autorefs-internal" title="ParamInfo


  
      dataclass
   (func_to_web.analyze_function.ParamInfo)" href=#func_to_web.analyze_function.ParamInfo>ParamInfo</a></code> </td> <td> <div class=doc-md-description> <p>ParamInfo with type and constraints.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>Validated and converted item.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>func_to_web\validate_params.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=k>def</span><span class=w> </span><span class=nf>validate_single_item</span><span class=p>(</span><span class=n>item</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=n>info</span><span class=p>:</span> <span class=n>ParamInfo</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Validate a single list item.</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>    Reuses the same validation logic as non-list parameters.</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>    Args:</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>        item: The item value from the JSON array.</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><span class=sd>        info: ParamInfo with type and constraints.</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=sd>    Returns:</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>        Validated and converted item.</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>    <span class=c1># Handle None/null values</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>    <span class=k>if</span> <span class=n>item</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>    <span class=c1># Bool (already bool from JSON)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>    <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>        <span class=k>return</span> <span class=nb>bool</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=c1># Date (comes as string from JSON)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>    <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=n>date</span><span class=p>:</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>            <span class=k>return</span> <span class=n>date</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=k>return</span> <span class=n>item</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>    <span class=c1># Time (comes as string from JSON)</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>    <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=n>time</span><span class=p>:</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>            <span class=k>return</span> <span class=n>time</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=k>return</span> <span class=n>item</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>    <span class=c1># Literal in lists is not supported (prohibited by analyze())</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>    <span class=k>if</span> <span class=n>get_origin</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>)</span> <span class=ow>is</span> <span class=n>Literal</span><span class=p>:</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;list[Literal[...]] is not supported&quot;</span><span class=p>)</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>    <span class=c1># Expand shorthand hex colors (#RGB -&gt; #RRGGBB)</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>    <span class=k>if</span> <span class=n>item</span> <span class=ow>and</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=ow>and</span> <span class=n>item</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;#&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>        <span class=n>item</span> <span class=o>=</span> <span class=s1>&#39;#&#39;</span> <span class=o>+</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>c</span><span class=o>*</span><span class=mi>2</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>item</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>    <span class=c1># Number types: ensure conversion from string if needed</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>    <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>in</span> <span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>):</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>            <span class=n>item</span> <span class=o>=</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>)):</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>            <span class=c1># JSON already parsed it as number</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>            <span class=n>item</span> <span class=o>=</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>    <span class=c1># Pydantic validation with constraints</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>    <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>field_info</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>,</span> <span class=s1>&#39;metadata&#39;</span><span class=p>):</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>        <span class=n>adapter</span> <span class=o>=</span> <span class=n>TypeAdapter</span><span class=p>(</span><span class=n>Annotated</span><span class=p>[</span><span class=n>info</span><span class=o>.</span><span class=n>type</span><span class=p>,</span> <span class=n>info</span><span class=o>.</span><span class=n>field_info</span><span class=p>])</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>        <span class=k>return</span> <span class=n>adapter</span><span class=o>.</span><span class=n>validate_python</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a>        <span class=c1># Basic type conversion for types without constraints</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>        <span class=k>if</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>in</span> <span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>):</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>            <span class=c1># Already converted above</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>            <span class=k>return</span> <span class=n>item</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=k>elif</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span> <span class=ow>is</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>            <span class=k>return</span> <span class=nb>str</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=k>if</span> <span class=n>item</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>            <span class=c1># For other types (shouldn&#39;t reach here normally)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>            <span class=k>return</span> <span class=n>info</span><span class=o>.</span><span class=n>type</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=k>if</span> <span class=n>item</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/offerrall/FuncToWeb target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://twitter.com/offerrall target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.indexes", "content.code.copy", "content.code.annotate", "toc.integrate", "navigation.tabs.sticky", "navigation.top", {"hide": ["toc.title"]}], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.e71a0d61.min.js></script> </body> </html>